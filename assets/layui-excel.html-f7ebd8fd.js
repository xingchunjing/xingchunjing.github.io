import{_ as e,X as o,Y as c,Z as n,$ as s,a0 as t,a2 as p,E as l}from"./framework-f01f539c.js";const i={},u=n("h1",{id:"excel下载",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#excel下载","aria-hidden":"true"},"#"),s(" excel下载")],-1),r=n("p",null,"layui table 用于对表格进行一些列功能和动态化数据操作，涵盖了日常业务所涉及的几乎全部需求。支持固定表头、固定行、固定列左/列右，支持拖拽改变列宽度，支持排序，支持多级表头，支持单元格的自定义模板，支持对表格重载（比如搜索、条件筛选等），支持复选框，支持分页，支持单元格编辑等等一些列功能。",-1),k=n("p",null,"Spring Boot 整合template 结合layui能很好的实现一些需求",-1),d=n("p",null,"下面介绍一下layui和excel的下载功能",-1),v=n("h2",{id:"layui的简单使用",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#layui的简单使用","aria-hidden":"true"},"#"),s(" layui的简单使用")],-1),m={href:"http://layui.dotnetcms.cn/web/",target:"_blank",rel:"noopener noreferrer"},y=p(`<h3 id="创建表格标签" tabindex="-1"><a class="header-anchor" href="#创建表格标签" aria-hidden="true">#</a> 创建表格标签</h3><hr><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>event_table<span class="token punctuation">&quot;</span></span> <span class="token attr-name">lay-filter</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>event_table<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>layui-hide<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="引入js文件" tabindex="-1"><a class="header-anchor" href="#引入js文件" aria-hidden="true">#</a> 引入js文件</h3><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token comment">&lt;!--  三方功能js引入--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name"><span class="token namespace">th:</span>src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/layui/layui.js}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name"><span class="token namespace">th:</span>src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/js/jquery.min.js}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name"><span class="token namespace">th:</span>src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/layui/exts/excel.js}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--  项目js引入--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{/js/event.js}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="项目js" tabindex="-1"><a class="header-anchor" href="#项目js" aria-hidden="true">#</a> 项目js</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>layui<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;element&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;form&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;laydate&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;laypage&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;table&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> layer <span class="token operator">=</span> layui<span class="token punctuation">.</span>layer <span class="token comment">//获得layer模块</span>
        <span class="token punctuation">,</span>laypage <span class="token operator">=</span> layui<span class="token punctuation">.</span>laypage <span class="token comment">//获得laypage模块</span>
        <span class="token punctuation">,</span>laydate <span class="token operator">=</span> layui<span class="token punctuation">.</span>laydate <span class="token comment">//获得laydate模块</span>
        <span class="token punctuation">,</span>form <span class="token operator">=</span> layui<span class="token punctuation">.</span>form
        <span class="token punctuation">,</span>element <span class="token operator">=</span> layui<span class="token punctuation">.</span>element
        <span class="token punctuation">,</span>table <span class="token operator">=</span> layui<span class="token punctuation">.</span>table<span class="token punctuation">;</span>

    <span class="token comment">//laydate实例使用</span>
    laydate<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">elem</span><span class="token operator">:</span> <span class="token string">&#39;#startTime&#39;</span> <span class="token comment">//指定元素</span>
        <span class="token punctuation">,</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;datetime&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    laydate<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">elem</span><span class="token operator">:</span> <span class="token string">&#39;#endTime&#39;</span> <span class="token comment">//指定元素</span>
        <span class="token punctuation">,</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;datetime&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//form使用模块</span>
    <span class="token keyword">var</span> gameId <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>count<span class="token operator">=</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>channelId<span class="token operator">=</span><span class="token string">&#39;&#39;</span><span class="token punctuation">;</span>
    form<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;select(gameId)&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        gameId <span class="token operator">=</span> data<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>gameId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    form<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;select(channelId)&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        channelId <span class="token operator">=</span> data<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>channelId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//监听提交</span>
    form<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;submit(formDemo)&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>gameId<span class="token operator">==</span><span class="token string">&#39;&#39;</span><span class="token operator">||</span>gameId<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">&quot;游戏种类必填&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//失败的表情</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">var</span> userId <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#userId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> channelUid <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#channelUid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> startTime <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#startTime&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> endTime <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#endTime&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> param <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string-property property">&#39;gameId&#39;</span><span class="token operator">:</span>gameId<span class="token punctuation">,</span><span class="token string-property property">&#39;channelId&#39;</span><span class="token operator">:</span>channelId<span class="token punctuation">,</span><span class="token string-property property">&#39;userId&#39;</span><span class="token operator">:</span>userId<span class="token punctuation">,</span><span class="token string-property property">&#39;startTime&#39;</span><span class="token operator">:</span>startTime<span class="token punctuation">,</span><span class="token string-property property">&#39;endTime&#39;</span><span class="token operator">:</span>endTime<span class="token punctuation">,</span><span class="token string-property property">&#39;channelUid&#39;</span><span class="token operator">:</span>channelUid<span class="token punctuation">}</span>
        table<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token string">&#39;event_table&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">page</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token comment">//page参数是指重新刷新后从第几页开始</span>
                <span class="token literal-property property">curr</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token comment">//重新从第 1 页开始</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">,</span> <span class="token literal-property property">where</span><span class="token operator">:</span> param
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">//第一个实例</span>
    table<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">elem</span><span class="token operator">:</span> <span class="token string">&#39;#event_table&#39;</span>
        <span class="token punctuation">,</span><span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">500</span>
        <span class="token punctuation">,</span><span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;/oversea/template/select/event&#39;</span> <span class="token comment">//数据接口</span>
        <span class="token punctuation">,</span><span class="token literal-property property">toolbar</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">,</span><span class="token literal-property property">page</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">//开启分页</span>
        <span class="token punctuation">,</span><span class="token literal-property property">cols</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>
            <span class="token punctuation">{</span><span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">&#39;gameId&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;游戏id&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">&#39;channelId&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;渠道id&#39;</span><span class="token punctuation">,</span>  <span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">&#39;serverId&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;区服id&#39;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">&#39;userId&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;用户ID&#39;</span><span class="token punctuation">,</span><span class="token function-variable function">templet</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> d<span class="token punctuation">.</span>userId<span class="token operator">+</span><span class="token string">&quot;\\t&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">&#39;roleId&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;角色id&#39;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">&#39;channelUid&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;平台id&#39;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">&#39;eventId&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;事件id&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">&#39;createTime&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;事件时间&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token function-variable function">done</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> curr<span class="token punctuation">,</span> count</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            pageCurr<span class="token operator">=</span>curr<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">downloadBtn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						
	layui<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token string">&#39;layer&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">var</span> layer <span class="token operator">=</span> layui<span class="token punctuation">.</span>layer <span class="token comment">//获得layer模块</span>
        
	    <span class="token keyword">var</span> gameId <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#gameId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token keyword">if</span><span class="token punctuation">(</span>gameId<span class="token operator">==</span><span class="token string">&#39;&#39;</span><span class="token operator">||</span>gameId<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">&quot;游戏种类必填&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//失败的表情</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">var</span> channelId <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#channelId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token keyword">if</span><span class="token punctuation">(</span>channelId<span class="token operator">==</span><span class="token string">&#39;&#39;</span><span class="token operator">||</span>channelId<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">&quot;渠道种类必填&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//失败的表情</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">var</span> userId <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#userId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> channelUid <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#channelUid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> startTime <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#startTime&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> endTime <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#endTime&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> param <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string-property property">&#39;gameId&#39;</span><span class="token operator">:</span>gameId<span class="token punctuation">,</span><span class="token string-property property">&#39;channelId&#39;</span><span class="token operator">:</span>channelId<span class="token punctuation">,</span><span class="token string-property property">&#39;userId&#39;</span><span class="token operator">:</span>userId<span class="token punctuation">,</span><span class="token string-property property">&#39;startTime&#39;</span><span class="token operator">:</span>startTime<span class="token punctuation">,</span><span class="token string-property property">&#39;endTime&#39;</span><span class="token operator">:</span>endTime<span class="token punctuation">,</span><span class="token string-property property">&#39;channelUid&#39;</span><span class="token operator">:</span>channelUid<span class="token punctuation">}</span>
        $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;/oversea/template/download/event&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">data</span><span class="token operator">:</span> param<span class="token punctuation">,</span>
            <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				        <span class="token comment">//将字符串，转换为json对象</span>
				        <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">.</span>data<span class="token punctuation">;</span>
                <span class="token comment">//过滤，切换数据顺序</span>
                data <span class="token operator">=</span> <span class="token constant">LAY_EXCEL</span><span class="token punctuation">.</span><span class="token function">filterExportData</span><span class="token punctuation">(</span>
                    data<span class="token punctuation">,</span>
                    <span class="token punctuation">[</span><span class="token string">&#39;gameId&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;channelId&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;serverId&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;userId&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;roleId&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;channelUid&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;eventId&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;createTime&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token comment">//设置表头</span>
                data<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>
                    <span class="token punctuation">{</span>
                        <span class="token literal-property property">gameId</span><span class="token operator">:</span><span class="token string">&#39;gameId&#39;</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">channelId</span><span class="token operator">:</span><span class="token string">&#39;channelId&#39;</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">serverId</span><span class="token operator">:</span><span class="token string">&#39;serverId&#39;</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">userId</span><span class="token operator">:</span><span class="token string">&#39;userId&#39;</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">roleId</span><span class="token operator">:</span><span class="token string">&#39;roleId&#39;</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">channelUid</span><span class="token operator">:</span><span class="token string">&#39;channelUid&#39;</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">eventId</span><span class="token operator">:</span><span class="token string">&#39;eventId&#39;</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">createTime</span><span class="token operator">:</span><span class="token string">&#39;createTime&#39;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token comment">//下载数据</span>
                <span class="token constant">LAY_EXCEL</span><span class="token punctuation">.</span><span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">sheet1</span><span class="token operator">:</span>data<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&#39;表格导出.xlsx&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;xlsx&#39;</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">特别说明</p><p>直接参考官方文档也可</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span><span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">&#39;userId&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;用户ID&#39;</span><span class="token punctuation">,</span><span class="token function-variable function">templet</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> d<span class="token punctuation">.</span>userId<span class="token operator">+</span><span class="token string">&quot;\\t&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><p>这一行是为了，在使用layui自带的excel下载功能时，出现科学计数法的处理<code>templet: function(d){return d.userId+&quot;\\t&quot;</code></p></li><li><p><code>toolbar: true</code>:配置以后会开启表格头部工具栏区域，可以支持下载功能</p></li></ul></div><p>使用自带的excel下载功能存在部分局限，无法下载全部数据(需要调整分页显示情况)，所以使用三方的excel下载功能</p><h2 id="excel下载-1" tabindex="-1"><a class="header-anchor" href="#excel下载-1" aria-hidden="true">#</a> excel下载</h2>`,10),b={href:"https://gitee.com/wangerzi/layui-excel",target:"_blank",rel:"noopener noreferrer"},g=p(`<p>使用项目的几种方式</p><h3 id="npm安装" tabindex="-1"><a class="header-anchor" href="#npm安装" aria-hidden="true">#</a> npm安装</h3><hr><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">npm</span> i lay-excel
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后使用 import 引入并调用导出函数</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token constant">LAY_EXCEL</span> <span class="token keyword">from</span> <span class="token string">&#39;lay-excel&#39;</span><span class="token punctuation">;</span>
<span class="token constant">LAY_EXCEL</span><span class="token punctuation">.</span><span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;表格导出.xlsx&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;xlsx&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="script引入" tabindex="-1"><a class="header-anchor" href="#script引入" aria-hidden="true">#</a> script引入</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;layui_exts/excel.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token constant">LAY_EXCEL</span><span class="token punctuation">.</span><span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;表格导出.xlsx&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;xlsx&#39;</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="layui插件引入" tabindex="-1"><a class="header-anchor" href="#layui插件引入" aria-hidden="true">#</a> Layui插件引入</h3><hr><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>layui<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token string">&#39;layui_exts/&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 配置一个可访问地址</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">excel</span><span class="token operator">:</span> <span class="token string">&#39;excel&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
layui<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;excel&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    layui<span class="token punctuation">.</span>excel<span class="token punctuation">.</span><span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;表格导出.xlsx&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;xlsx&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11),h=n("li",null,[n("strong",null,"本文作者："),s(" 景兴春")],-1),f=n("strong",null,"本文链接：",-1),x={href:"https://www.jingxc.top/front/layui-excel.html",target:"_blank",rel:"noopener noreferrer"},I=n("strong",null,"版权声明：",-1),q={href:"https://www.apache.org/licenses/LICENSE-2.0.html",target:"_blank",rel:"noopener noreferrer"};function _(w,j){const a=l("ExternalLinkIcon");return o(),c("div",null,[u,r,k,d,v,n("p",null,[s("form表单相关的部分就不做介绍了，可以查看"),n("a",m,[s("layui官方文档"),t(a)])]),y,n("p",null,[s("这个是通过第三方自己分装的插件，简化了到处流程 "),n("a",b,[s("excel插件下载"),t(a)])]),g,n("ul",null,[h,n("li",null,[f,s(),n("a",x,[s("https://www.jingxc.top/front/layui-excel.html"),t(a)])]),n("li",null,[I,s(" 本博客所有文章除特别声明外，均采用 "),n("a",q,[s("Apache License 2.0"),t(a)]),s(" 许可协议。转载请注明出处！")])])])}const E=e(i,[["render",_],["__file","layui-excel.html.vue"]]);export{E as default};
