<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://gitee.com/jing-xingchun/knowledge/hashmap.html"><meta property="og:site_name" content="Jingxc"><meta property="og:title" content="HashMap"><meta property="og:description" content="HashMap HashMapåŸºç¡€ HashMapå­˜å‚¨ç»“æ„ åœ¨JDK1.7ä¸­å’ŒJDK1.8ä¸­æœ‰æ‰€åŒºåˆ«ï¼š åœ¨JDK1.7ä¸­ï¼Œç”±â€æ•°ç»„+é“¾è¡¨â€œç»„æˆï¼Œæ•°ç»„æ˜¯HashMapçš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ã€‚ åœ¨JDK1.8ä¸­ï¼Œç”±â€œæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘â€ç»„æˆã€‚å½“é“¾è¡¨è¿‡é•¿ï¼Œåˆ™ä¼šä¸¥é‡å½±å“HashMapçš„æ€§èƒ½ï¼Œçº¢é»‘æ ‘æœç´¢æ—¶é—´å¤æ‚åº¦æ˜¯O(logn)ï¼Œè€Œé“¾è¡¨æ˜¯O(n)ã€‚å› æ­¤ï¼ŒJDK1.8å¯¹æ•°æ®ç»“æ„åšäº†è¿›ä¸€æ­¥çš„ä¼˜åŒ–ï¼Œå¼•å…¥äº†çº¢é»‘æ ‘ï¼Œé“¾è¡¨å’Œçº¢é»‘æ ‘åœ¨è¾¾åˆ°ä¸€å®šæ¡ä»¶ä¼šè¿›è¡Œè½¬æ¢ï¼š å½“é“¾è¡¨è¶…è¿‡8ä¸”æ•°ç»„é•¿åº¦(æ•°æ®æ€»é‡)è¶…è¿‡64æ‰ä¼šè½¬ä¸ºçº¢é»‘æ ‘ å°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘å‰ä¼šåˆ¤æ–­ï¼Œå¦‚æœå½“å‰æ•°ç»„çš„é•¿åº¦å°äº64ï¼Œé‚£ä¹ˆä¼šé€‰æ‹©å…ˆè¿›è¡Œæ•°ç»„æ‰©å®¹ï¼Œè€Œä¸æ˜¯è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚ ArrayListåº•å±‚æ˜¯åŠ¨æ€æ•°ç»„æ•°æ®ç»“æ„ï¼ŒæŸ¥è¯¢å¿«ï¼Œå¢åˆ æ…¢ï¼ˆå› ä¸ºArrayå¢åˆ éœ€è¦ç§»åŠ¨æ•°æ®ï¼‰ï¼ŒLinkedListåº•å±‚æ˜¯åŒé‡é“¾è¡¨æ•°æ®ç»“æ„ï¼ŒæŸ¥è¯¢ç›¸å¯¹è¾ƒæ…¢ï¼ˆå› ä¸ºLinkæŸ¥è¯¢éœ€è¦ç§»åŠ¨æŒ‡é’ˆï¼‰ï¼Œå¢åˆ å—ã€‚"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-05-05T14:07:29.000Z"><meta property="article:author" content="Jingxc"><meta property="article:tag" content="HashMap"><meta property="article:tag" content="java"><meta property="article:tag" content="åç«¯"><meta property="article:published_time" content="2022-06-23T00:00:00.000Z"><meta property="article:modified_time" content="2023-05-05T14:07:29.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"HashMap","image":[""],"datePublished":"2022-06-23T00:00:00.000Z","dateModified":"2023-05-05T14:07:29.000Z","author":[{"@type":"Person","name":"Jingxc","url":"/"}]}</script><title>HashMap | Jingxc</title><meta name="description" content="HashMap HashMapåŸºç¡€ HashMapå­˜å‚¨ç»“æ„ åœ¨JDK1.7ä¸­å’ŒJDK1.8ä¸­æœ‰æ‰€åŒºåˆ«ï¼š åœ¨JDK1.7ä¸­ï¼Œç”±â€æ•°ç»„+é“¾è¡¨â€œç»„æˆï¼Œæ•°ç»„æ˜¯HashMapçš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ã€‚ åœ¨JDK1.8ä¸­ï¼Œç”±â€œæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘â€ç»„æˆã€‚å½“é“¾è¡¨è¿‡é•¿ï¼Œåˆ™ä¼šä¸¥é‡å½±å“HashMapçš„æ€§èƒ½ï¼Œçº¢é»‘æ ‘æœç´¢æ—¶é—´å¤æ‚åº¦æ˜¯O(logn)ï¼Œè€Œé“¾è¡¨æ˜¯O(n)ã€‚å› æ­¤ï¼ŒJDK1.8å¯¹æ•°æ®ç»“æ„åšäº†è¿›ä¸€æ­¥çš„ä¼˜åŒ–ï¼Œå¼•å…¥äº†çº¢é»‘æ ‘ï¼Œé“¾è¡¨å’Œçº¢é»‘æ ‘åœ¨è¾¾åˆ°ä¸€å®šæ¡ä»¶ä¼šè¿›è¡Œè½¬æ¢ï¼š å½“é“¾è¡¨è¶…è¿‡8ä¸”æ•°ç»„é•¿åº¦(æ•°æ®æ€»é‡)è¶…è¿‡64æ‰ä¼šè½¬ä¸ºçº¢é»‘æ ‘ å°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘å‰ä¼šåˆ¤æ–­ï¼Œå¦‚æœå½“å‰æ•°ç»„çš„é•¿åº¦å°äº64ï¼Œé‚£ä¹ˆä¼šé€‰æ‹©å…ˆè¿›è¡Œæ•°ç»„æ‰©å®¹ï¼Œè€Œä¸æ˜¯è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚ ArrayListåº•å±‚æ˜¯åŠ¨æ€æ•°ç»„æ•°æ®ç»“æ„ï¼ŒæŸ¥è¯¢å¿«ï¼Œå¢åˆ æ…¢ï¼ˆå› ä¸ºArrayå¢åˆ éœ€è¦ç§»åŠ¨æ•°æ®ï¼‰ï¼ŒLinkedListåº•å±‚æ˜¯åŒé‡é“¾è¡¨æ•°æ®ç»“æ„ï¼ŒæŸ¥è¯¢ç›¸å¯¹è¾ƒæ…¢ï¼ˆå› ä¸ºLinkæŸ¥è¯¢éœ€è¦ç§»åŠ¨æŒ‡é’ˆï¼‰ï¼Œå¢åˆ å—ã€‚">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-f9909eef.css" as="style"><link rel="stylesheet" href="/assets/style-f9909eef.css">
    <link rel="modulepreload" href="/assets/app-2a97de68.js"><link rel="modulepreload" href="/assets/framework-a5b3b151.js"><link rel="modulepreload" href="/assets/hashmap.html-3c402469.js"><link rel="modulepreload" href="/assets/hashmap.html-c5b0c4ee.js"><link rel="prefetch" href="/assets/index.html-d4bd3cd7.js" as="script"><link rel="prefetch" href="/assets/index.html-c96f7608.js" as="script"><link rel="prefetch" href="/assets/index.html-bf6a472c.js" as="script"><link rel="prefetch" href="/assets/contact.html-47d36da3.js" as="script"><link rel="prefetch" href="/assets/slideme.html-252ab948.js" as="script"><link rel="prefetch" href="/assets/index.html-0159b07e.js" as="script"><link rel="prefetch" href="/assets/bio-nio.html-91b55dac.js" as="script"><link rel="prefetch" href="/assets/jvm.html-3ac18c76.js" as="script"><link rel="prefetch" href="/assets/redis-cache.html-f95898b4.js" as="script"><link rel="prefetch" href="/assets/thread.html-854ad941.js" as="script"><link rel="prefetch" href="/assets/index.html-b10b8efd.js" as="script"><link rel="prefetch" href="/assets/index.html-2c539521.js" as="script"><link rel="prefetch" href="/assets/linux_jstack.html-98bf0669.js" as="script"><link rel="prefetch" href="/assets/index.html-8a37f515.js" as="script"><link rel="prefetch" href="/assets/ws.html-70802992.js" as="script"><link rel="prefetch" href="/assets/index.html-f6a1382d.js" as="script"><link rel="prefetch" href="/assets/logger-level.html-e8fef394.js" as="script"><link rel="prefetch" href="/assets/logger.html-256e419b.js" as="script"><link rel="prefetch" href="/assets/more-mysql.html-58e0eb16.js" as="script"><link rel="prefetch" href="/assets/redis-cache.html-946742d5.js" as="script"><link rel="prefetch" href="/assets/sharding-sphere.html-a64d86aa.js" as="script"><link rel="prefetch" href="/assets/index.html-6e2faf4a.js" as="script"><link rel="prefetch" href="/assets/login-facebook.html-700b4e86.js" as="script"><link rel="prefetch" href="/assets/login-google.html-c0c19066.js" as="script"><link rel="prefetch" href="/assets/index.html-0437c555.js" as="script"><link rel="prefetch" href="/assets/apple-pay.html-c902ed81.js" as="script"><link rel="prefetch" href="/assets/java-google.html-a63dfcf6.js" as="script"><link rel="prefetch" href="/assets/java-google_rep.html-83aa69ea.js" as="script"><link rel="prefetch" href="/assets/java-paypal.html-73ba5c48.js" as="script"><link rel="prefetch" href="/assets/java-xsolla.html-d88ee2f0.js" as="script"><link rel="prefetch" href="/assets/razer-pay.html-7d0f70a5.js" as="script"><link rel="prefetch" href="/assets/index.html-5ba381b9.js" as="script"><link rel="prefetch" href="/assets/git.html-be3360e9.js" as="script"><link rel="prefetch" href="/assets/io-stream.html-e33a5eb7.js" as="script"><link rel="prefetch" href="/assets/index.html-28c08778.js" as="script"><link rel="prefetch" href="/assets/io-stream.html-8bbfd57f.js" as="script"><link rel="prefetch" href="/assets/index.html-e9952c4e.js" as="script"><link rel="prefetch" href="/assets/fdir.html-643f9c42.js" as="script"><link rel="prefetch" href="/assets/firewalld.html-6d0afb45.js" as="script"><link rel="prefetch" href="/assets/tpid.html-4e515f97.js" as="script"><link rel="prefetch" href="/assets/404.html-96d8cf7c.js" as="script"><link rel="prefetch" href="/assets/index.html-3cb75fc7.js" as="script"><link rel="prefetch" href="/assets/index.html-bdf9e7d3.js" as="script"><link rel="prefetch" href="/assets/index.html-0e99d33e.js" as="script"><link rel="prefetch" href="/assets/index.html-8cd72f94.js" as="script"><link rel="prefetch" href="/assets/index.html-290ee35c.js" as="script"><link rel="prefetch" href="/assets/index.html-9b27e9ce.js" as="script"><link rel="prefetch" href="/assets/index.html-3006a63a.js" as="script"><link rel="prefetch" href="/assets/index.html-2173f166.js" as="script"><link rel="prefetch" href="/assets/index.html-cc4978eb.js" as="script"><link rel="prefetch" href="/assets/index.html-0608689b.js" as="script"><link rel="prefetch" href="/assets/index.html-5358aaf3.js" as="script"><link rel="prefetch" href="/assets/index.html-b6504bee.js" as="script"><link rel="prefetch" href="/assets/index.html-762f8ed9.js" as="script"><link rel="prefetch" href="/assets/index.html-6db6be11.js" as="script"><link rel="prefetch" href="/assets/index.html-c27fc63d.js" as="script"><link rel="prefetch" href="/assets/index.html-68ca5296.js" as="script"><link rel="prefetch" href="/assets/index.html-c54f7a21.js" as="script"><link rel="prefetch" href="/assets/index.html-8264960d.js" as="script"><link rel="prefetch" href="/assets/index.html-a75e8b41.js" as="script"><link rel="prefetch" href="/assets/index.html-fe8b9855.js" as="script"><link rel="prefetch" href="/assets/index.html-c6299f99.js" as="script"><link rel="prefetch" href="/assets/index.html-3953590a.js" as="script"><link rel="prefetch" href="/assets/index.html-fe0dedd2.js" as="script"><link rel="prefetch" href="/assets/index.html-ac5f5115.js" as="script"><link rel="prefetch" href="/assets/index.html-673814e3.js" as="script"><link rel="prefetch" href="/assets/index.html-920f0212.js" as="script"><link rel="prefetch" href="/assets/index.html-77db15ea.js" as="script"><link rel="prefetch" href="/assets/index.html-d770f4b9.js" as="script"><link rel="prefetch" href="/assets/index.html-932b5c72.js" as="script"><link rel="prefetch" href="/assets/index.html-60cc3113.js" as="script"><link rel="prefetch" href="/assets/index.html-d96dbf10.js" as="script"><link rel="prefetch" href="/assets/index.html-47fd1801.js" as="script"><link rel="prefetch" href="/assets/index.html-0a85a4ef.js" as="script"><link rel="prefetch" href="/assets/index.html-521d6d0b.js" as="script"><link rel="prefetch" href="/assets/index.html-f0adb6c2.js" as="script"><link rel="prefetch" href="/assets/index.html-58c252d8.js" as="script"><link rel="prefetch" href="/assets/index.html-97e35f9d.js" as="script"><link rel="prefetch" href="/assets/index.html-8f73b57b.js" as="script"><link rel="prefetch" href="/assets/index.html-77ff19a2.js" as="script"><link rel="prefetch" href="/assets/index.html-4f596961.js" as="script"><link rel="prefetch" href="/assets/contact.html-0b70a751.js" as="script"><link rel="prefetch" href="/assets/slideme.html-cc4df85b.js" as="script"><link rel="prefetch" href="/assets/index.html-f6f092e7.js" as="script"><link rel="prefetch" href="/assets/bio-nio.html-828690e0.js" as="script"><link rel="prefetch" href="/assets/jvm.html-00a98efa.js" as="script"><link rel="prefetch" href="/assets/redis-cache.html-b416f212.js" as="script"><link rel="prefetch" href="/assets/thread.html-c1c94dd6.js" as="script"><link rel="prefetch" href="/assets/index.html-a72f2046.js" as="script"><link rel="prefetch" href="/assets/index.html-d3464ae7.js" as="script"><link rel="prefetch" href="/assets/linux_jstack.html-8559e7c0.js" as="script"><link rel="prefetch" href="/assets/index.html-3ae5c5aa.js" as="script"><link rel="prefetch" href="/assets/ws.html-7c3bdc8f.js" as="script"><link rel="prefetch" href="/assets/index.html-d0e6540f.js" as="script"><link rel="prefetch" href="/assets/logger-level.html-e7a0c3a1.js" as="script"><link rel="prefetch" href="/assets/logger.html-bed4ad63.js" as="script"><link rel="prefetch" href="/assets/more-mysql.html-ea2f1523.js" as="script"><link rel="prefetch" href="/assets/redis-cache.html-0676071e.js" as="script"><link rel="prefetch" href="/assets/sharding-sphere.html-18f25b1f.js" as="script"><link rel="prefetch" href="/assets/index.html-8ecb6cfa.js" as="script"><link rel="prefetch" href="/assets/login-facebook.html-62611b22.js" as="script"><link rel="prefetch" href="/assets/login-google.html-6b47bb97.js" as="script"><link rel="prefetch" href="/assets/index.html-032cf4e5.js" as="script"><link rel="prefetch" href="/assets/apple-pay.html-318908a2.js" as="script"><link rel="prefetch" href="/assets/java-google.html-7aebd45a.js" as="script"><link rel="prefetch" href="/assets/java-google_rep.html-ad97c0b4.js" as="script"><link rel="prefetch" href="/assets/java-paypal.html-5815e80b.js" as="script"><link rel="prefetch" href="/assets/java-xsolla.html-13b2fa19.js" as="script"><link rel="prefetch" href="/assets/razer-pay.html-d534c2d3.js" as="script"><link rel="prefetch" href="/assets/index.html-2d7ffcc2.js" as="script"><link rel="prefetch" href="/assets/git.html-07d79518.js" as="script"><link rel="prefetch" href="/assets/io-stream.html-7eace48b.js" as="script"><link rel="prefetch" href="/assets/index.html-f6b756a6.js" as="script"><link rel="prefetch" href="/assets/io-stream.html-a1807480.js" as="script"><link rel="prefetch" href="/assets/index.html-12411117.js" as="script"><link rel="prefetch" href="/assets/fdir.html-4024352a.js" as="script"><link rel="prefetch" href="/assets/firewalld.html-2d6d1686.js" as="script"><link rel="prefetch" href="/assets/tpid.html-32f3bfcd.js" as="script"><link rel="prefetch" href="/assets/404.html-174ccd3c.js" as="script"><link rel="prefetch" href="/assets/index.html-7291e6c0.js" as="script"><link rel="prefetch" href="/assets/index.html-21cb9483.js" as="script"><link rel="prefetch" href="/assets/index.html-fc6df787.js" as="script"><link rel="prefetch" href="/assets/index.html-3613b669.js" as="script"><link rel="prefetch" href="/assets/index.html-4ccb5604.js" as="script"><link rel="prefetch" href="/assets/index.html-f1bf9c14.js" as="script"><link rel="prefetch" href="/assets/index.html-2865bfcd.js" as="script"><link rel="prefetch" href="/assets/index.html-5afc6ba2.js" as="script"><link rel="prefetch" href="/assets/index.html-f0dbd719.js" as="script"><link rel="prefetch" href="/assets/index.html-a85c8870.js" as="script"><link rel="prefetch" href="/assets/index.html-d6a8ee2a.js" as="script"><link rel="prefetch" href="/assets/index.html-6986a5b7.js" as="script"><link rel="prefetch" href="/assets/index.html-299f5ed3.js" as="script"><link rel="prefetch" href="/assets/index.html-cec2abee.js" as="script"><link rel="prefetch" href="/assets/index.html-4c1d036e.js" as="script"><link rel="prefetch" href="/assets/index.html-55d9ea3b.js" as="script"><link rel="prefetch" href="/assets/index.html-a59afffb.js" as="script"><link rel="prefetch" href="/assets/index.html-3941535b.js" as="script"><link rel="prefetch" href="/assets/index.html-3d8c93ae.js" as="script"><link rel="prefetch" href="/assets/index.html-ccb2151a.js" as="script"><link rel="prefetch" href="/assets/index.html-2a171d5b.js" as="script"><link rel="prefetch" href="/assets/index.html-69638e40.js" as="script"><link rel="prefetch" href="/assets/index.html-862ccf8d.js" as="script"><link rel="prefetch" href="/assets/index.html-2d2cdbf9.js" as="script"><link rel="prefetch" href="/assets/index.html-a14e79ec.js" as="script"><link rel="prefetch" href="/assets/index.html-eea64e62.js" as="script"><link rel="prefetch" href="/assets/index.html-966b9fa6.js" as="script"><link rel="prefetch" href="/assets/index.html-bbbd620c.js" as="script"><link rel="prefetch" href="/assets/index.html-cbbb89b8.js" as="script"><link rel="prefetch" href="/assets/index.html-72896a37.js" as="script"><link rel="prefetch" href="/assets/index.html-e8a972d9.js" as="script"><link rel="prefetch" href="/assets/index.html-5df5953f.js" as="script"><link rel="prefetch" href="/assets/index.html-6c20b4e4.js" as="script"><link rel="prefetch" href="/assets/index.html-c547c31e.js" as="script"><link rel="prefetch" href="/assets/index.html-397e334d.js" as="script"><link rel="prefetch" href="/assets/index.html-931d0f5d.js" as="script"><link rel="prefetch" href="/assets/index.html-49409458.js" as="script"><link rel="prefetch" href="/assets/giscus-f311b0ba.js" as="script"><link rel="prefetch" href="/assets/auto-fa8841cf.js" as="script"><link rel="prefetch" href="/assets/index-b03bef79.js" as="script"><link rel="prefetch" href="/assets/flowchart-8b576787.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-2090cad9.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-75b11b9d.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-0191f9da.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-a106bb2c.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-ab04f0b1.js" as="script"><link rel="prefetch" href="/assets/search.esm-7e6792e2.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/VuePlayground-1c48e354.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-36cd6c3c.js" as="script"><link rel="prefetch" href="/assets/SearchResult-5520ad9a.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a href="/" class="brand"><img class="logo" src="/logo_1.png" alt="Jingxc"><!----><span class="site-name hide-in-pad">Jingxc</span></a><!--]--><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!--[--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="ä¸»é¡µ"><span class="font-icon icon iconfont icon-home" style=""></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/front/" class="nav-link" aria-label="å‰ç«¯"><span class="font-icon icon iconfont icon-template" style=""></span>å‰ç«¯<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="åç«¯"><span class="title"><span class="font-icon icon iconfont icon-java" style=""></span>åç«¯</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>å……å€¼</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/back/payment/java-google.html" class="nav-link" aria-label="googleå†…è´­"><span class="font-icon icon iconfont icon-card" style=""></span>googleå†…è´­<!----></a></li><li class="dropdown-subitem"><a href="/back/payment/java-google_rep.html" class="nav-link" aria-label="googleå†…è´­(è¡¥å……)"><span class="font-icon icon iconfont icon-card" style=""></span>googleå†…è´­(è¡¥å……)<!----></a></li><li class="dropdown-subitem"><a href="/back/payment/apple-pay.html" class="nav-link" aria-label="appleå†…è´­"><span class="font-icon icon iconfont icon-card" style=""></span>appleå†…è´­<!----></a></li><li class="dropdown-subitem"><a href="/back/payment/java-paypal.html" class="nav-link" aria-label="paypalæ”¯ä»˜"><span class="font-icon icon iconfont icon-card" style=""></span>paypalæ”¯ä»˜<!----></a></li><li class="dropdown-subitem"><a href="/back/payment/java-xsolla.html" class="nav-link" aria-label="xsollaæ”¯ä»˜"><span class="font-icon icon iconfont icon-card" style=""></span>xsollaæ”¯ä»˜<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>ç™»é™†</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/back/login/login-facebook.html" class="nav-link" aria-label="facebookç™»é™†"><span class="font-icon icon iconfont icon-group" style=""></span>facebookç™»é™†<!----></a></li><li class="dropdown-subitem"><a href="/back/login/login-google.html" class="nav-link" aria-label="googleç™»é™†"><span class="font-icon icon iconfont icon-group" style=""></span>googleç™»é™†<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/opera/" class="nav-link" aria-label="è¿ç»´"><span class="font-icon icon iconfont icon-linux" style=""></span>è¿ç»´<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="å¾®æœåŠ¡"><span class="title"><span class="font-icon icon iconfont icon-leaf" style=""></span>å¾®æœåŠ¡</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/spring/logger.html" class="nav-link" aria-label="æ—¥å¿—æ”¶é›†"><span class="font-icon icon iconfont icon-flow" style=""></span>æ—¥å¿—æ”¶é›†<!----></a></li><li class="dropdown-item"><a href="/spring/logger-level.html" class="nav-link" aria-label="æ—¥å¿—åˆ†çº§"><span class="font-icon icon iconfont icon-flow" style=""></span>æ—¥å¿—åˆ†çº§<!----></a></li><li class="dropdown-item"><a href="/spring/redis-cache.html" class="nav-link" aria-label="ç¼“å­˜é…ç½®"><span class="font-icon icon iconfont icon-cache" style=""></span>ç¼“å­˜é…ç½®<!----></a></li><li class="dropdown-item"><a href="/spring/more-mysql.html" class="nav-link" aria-label="å¤šæ•°æ®æº"><span class="font-icon icon iconfont icon-mysql" style=""></span>å¤šæ•°æ®æº<!----></a></li><li class="dropdown-item"><a href="/spring/sharding-sphere.html" class="nav-link" aria-label="æ•°æ®åº“ä¸­é—´ä»¶"><span class="font-icon icon iconfont icon-mysql" style=""></span>æ•°æ®åº“ä¸­é—´ä»¶<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/knowledge/" class="nav-link active" aria-label="çŸ¥è¯†ç‚¹"><span class="font-icon icon iconfont icon-note" style=""></span>çŸ¥è¯†ç‚¹<!----></a></div><div class="nav-item hide-in-mobile"><a href="/me/" class="nav-link" aria-label="ä¸ªäººç®€å†"><span class="font-icon icon iconfont icon-people" style=""></span>ä¸ªäººç®€å†<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item"><a class="repo-link" href="https://gitee.com/jing-xingchun/" target="_blank" rel="noopener noreferrer" aria-label="Gitee"><svg xmlns="http://www.w3.org/2000/svg" class="icon gitee-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="gitee icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm242.97-533.34H482.39a23.7 23.7 0 0 0-23.7 23.7l-.03 59.28c0 13.08 10.59 23.7 23.7 23.7h165.96a23.7 23.7 0 0 1 23.7 23.7v11.85a71.1 71.1 0 0 1-71.1 71.1H375.71a23.7 23.7 0 0 1-23.7-23.7V423.11a71.1 71.1 0 0 1 71.1-71.1h331.8a23.7 23.7 0 0 0 23.7-23.7l.06-59.25a23.73 23.73 0 0 0-23.7-23.73H423.11a177.78 177.78 0 0 0-177.78 177.75v331.83c0 13.08 10.62 23.7 23.7 23.7h349.62a159.99 159.99 0 0 0 159.99-159.99V482.33a23.7 23.7 0 0 0-23.7-23.7z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" class="outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" role="search" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">æœç´¢</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/knowledge/thread.html" class="nav-link sidebar-link sidebar-page" aria-label="çº¿ç¨‹"><span class="font-icon icon iconfont icon-asynchronous" style=""></span>çº¿ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/knowledge/hashmap.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="HashMap"><span class="font-icon icon iconfont icon-map" style=""></span>HashMap<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#hashmapåŸºç¡€" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HashMapåŸºç¡€"><!---->HashMapåŸºç¡€<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#hashmapå­˜å‚¨ç»“æ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HashMapå­˜å‚¨ç»“æ„"><!---->HashMapå­˜å‚¨ç»“æ„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#hashmapçš„nodeå±æ€§" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HashMapçš„nodeå±æ€§"><!---->HashMapçš„nodeå±æ€§<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#hashmapçš„å®¹é‡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HashMapçš„å®¹é‡"><!---->HashMapçš„å®¹é‡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#hashmapçš„è´Ÿè½½å› å­" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HashMapçš„è´Ÿè½½å› å­"><!---->HashMapçš„è´Ÿè½½å› å­<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#hashmapçš„hashç®—æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HashMapçš„hashç®—æ³•"><!---->HashMapçš„hashç®—æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#hashmapçš„æ•°ç»„-é“¾è¡¨-æ ‘" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HashMapçš„æ•°ç»„+é“¾è¡¨/æ ‘"><!---->HashMapçš„æ•°ç»„+é“¾è¡¨/æ ‘<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#hashmapä¸ºä»€ä¹ˆä¸ä¸€å¼€å§‹å°±ä½¿ç”¨çº¢é»‘æ ‘" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HashMapä¸ºä»€ä¹ˆä¸ä¸€å¼€å§‹å°±ä½¿ç”¨çº¢é»‘æ ‘"><!---->HashMapä¸ºä»€ä¹ˆä¸ä¸€å¼€å§‹å°±ä½¿ç”¨çº¢é»‘æ ‘<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#hashmapåº•å±‚æ•°ç»„å–å€¼æ—¶ä¸ºä»€ä¹ˆä¸ç”¨å–æ¨¡è€Œæ˜¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HashMapåº•å±‚æ•°ç»„å–å€¼æ—¶ä¸ºä»€ä¹ˆä¸ç”¨å–æ¨¡è€Œæ˜¯&amp;"><!---->HashMapåº•å±‚æ•°ç»„å–å€¼æ—¶ä¸ºä»€ä¹ˆä¸ç”¨å–æ¨¡è€Œæ˜¯&amp;<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#æŒ‡å®šæ•°ç»„é•¿åº¦ä¸æ˜¯2æ¬¡å¹‚-ä¼šç ´å2æ¬¡å¹‚è§„åˆ™å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æŒ‡å®šæ•°ç»„é•¿åº¦ä¸æ˜¯2æ¬¡å¹‚ï¼Œä¼šç ´å2æ¬¡å¹‚è§„åˆ™å—"><!---->æŒ‡å®šæ•°ç»„é•¿åº¦ä¸æ˜¯2æ¬¡å¹‚ï¼Œä¼šç ´å2æ¬¡å¹‚è§„åˆ™å—<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#hashmapæºç " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HashMapæºç "><!---->HashMapæºç <!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#_1-8çš„putæ–¹æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.8çš„putæ–¹æ³•"><!---->1.8çš„putæ–¹æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#_1-8çš„getæ–¹æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.8çš„getæ–¹æ³•"><!---->1.8çš„getæ–¹æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#_1-7hashmapçš„æ‰©å®¹åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.7HashMapçš„æ‰©å®¹åŸç†"><!---->1.7HashMapçš„æ‰©å®¹åŸç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#_1-7hashmapçš„æ‰©å®¹è¿‡ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.7HashMapçš„æ‰©å®¹è¿‡ç¨‹"><!---->1.7HashMapçš„æ‰©å®¹è¿‡ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#_1-8hsahmapçš„æ‰©å®¹åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.8HsahMapçš„æ‰©å®¹åŸç†"><!---->1.8HsahMapçš„æ‰©å®¹åŸç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#hsahmapçš„ä¸å®‰å…¨çš„åŸå› " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HsahMapçš„ä¸å®‰å…¨çš„åŸå› "><!---->HsahMapçš„ä¸å®‰å…¨çš„åŸå› <!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/knowledge/hashmap.html#jdk1-7å¤šçº¿ç¨‹hashmapå¹¶å‘putçš„æ—¶å€™ä¸ºä½•ä¼šå‘ç”Ÿç¯å½¢é“¾è¡¨-äº§ç”Ÿæ­»å¾ªç¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JDK1.7å¤šçº¿ç¨‹HashMapå¹¶å‘putçš„æ—¶å€™ä¸ºä½•ä¼šå‘ç”Ÿç¯å½¢é“¾è¡¨ï¼Œäº§ç”Ÿæ­»å¾ªç¯ï¼Ÿ"><!---->JDK1.7å¤šçº¿ç¨‹HashMapå¹¶å‘putçš„æ—¶å€™ä¸ºä½•ä¼šå‘ç”Ÿç¯å½¢é“¾è¡¨ï¼Œäº§ç”Ÿæ­»å¾ªç¯ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/knowledge/bio-nio.html" class="nav-link sidebar-link sidebar-page" aria-label="IOæ¨¡å‹"><span class="font-icon icon iconfont icon-IO" style=""></span>IOæ¨¡å‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/knowledge/jvm.html" class="nav-link sidebar-link sidebar-page" aria-label="jvm"><span class="font-icon icon iconfont icon-cycle" style=""></span>jvm<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/knowledge/redis-cache.html" class="nav-link sidebar-link sidebar-page" aria-label="redisç¼“å­˜"><span class="font-icon icon iconfont icon-cache" style=""></span>redisç¼“å­˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="font-icon icon iconfont icon-map" style=""></span>HashMap</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="/" target="_blank" rel="noopener noreferrer">Jingxc</a></span><span property="author" content="Jingxc"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-06-23T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 21 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT21M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category6 clickable" role="navigation">java</span><span class="page-category-item category2 clickable" role="navigation">åç«¯</span><!--]--><meta property="articleSection" content="java,åç«¯"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag3 clickable" role="navigation">HashMap</span><span class="page-tag-item tag6 clickable" role="navigation">java</span><span class="page-tag-item tag2 clickable" role="navigation">åç«¯</span><!--]--><meta property="keywords" content="HashMap,java,åç«¯"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#hashmapåŸºç¡€" class="router-link-active router-link-exact-active toc-link level2">HashMapåŸºç¡€</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#hashmapå­˜å‚¨ç»“æ„" class="router-link-active router-link-exact-active toc-link level3">HashMapå­˜å‚¨ç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#hashmapçš„nodeå±æ€§" class="router-link-active router-link-exact-active toc-link level3">HashMapçš„nodeå±æ€§</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#hashmapçš„å®¹é‡" class="router-link-active router-link-exact-active toc-link level3">HashMapçš„å®¹é‡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#hashmapçš„è´Ÿè½½å› å­" class="router-link-active router-link-exact-active toc-link level3">HashMapçš„è´Ÿè½½å› å­</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#hashmapçš„hashç®—æ³•" class="router-link-active router-link-exact-active toc-link level3">HashMapçš„hashç®—æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#hashmapçš„æ•°ç»„-é“¾è¡¨-æ ‘" class="router-link-active router-link-exact-active toc-link level3">HashMapçš„æ•°ç»„+é“¾è¡¨/æ ‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#hashmapä¸ºä»€ä¹ˆä¸ä¸€å¼€å§‹å°±ä½¿ç”¨çº¢é»‘æ ‘" class="router-link-active router-link-exact-active toc-link level3">HashMapä¸ºä»€ä¹ˆä¸ä¸€å¼€å§‹å°±ä½¿ç”¨çº¢é»‘æ ‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#hashmapåº•å±‚æ•°ç»„å–å€¼æ—¶ä¸ºä»€ä¹ˆä¸ç”¨å–æ¨¡è€Œæ˜¯" class="router-link-active router-link-exact-active toc-link level3">HashMapåº•å±‚æ•°ç»„å–å€¼æ—¶ä¸ºä»€ä¹ˆä¸ç”¨å–æ¨¡è€Œæ˜¯&amp;</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#æŒ‡å®šæ•°ç»„é•¿åº¦ä¸æ˜¯2æ¬¡å¹‚-ä¼šç ´å2æ¬¡å¹‚è§„åˆ™å—" class="router-link-active router-link-exact-active toc-link level3">æŒ‡å®šæ•°ç»„é•¿åº¦ä¸æ˜¯2æ¬¡å¹‚ï¼Œä¼šç ´å2æ¬¡å¹‚è§„åˆ™å—</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#hashmapæºç " class="router-link-active router-link-exact-active toc-link level2">HashMapæºç </a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#_1-8çš„putæ–¹æ³•" class="router-link-active router-link-exact-active toc-link level3">1.8çš„putæ–¹æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#_1-8çš„getæ–¹æ³•" class="router-link-active router-link-exact-active toc-link level3">1.8çš„getæ–¹æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#_1-7hashmapçš„æ‰©å®¹åŸç†" class="router-link-active router-link-exact-active toc-link level3">1.7HashMapçš„æ‰©å®¹åŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#_1-7hashmapçš„æ‰©å®¹è¿‡ç¨‹" class="router-link-active router-link-exact-active toc-link level3">1.7HashMapçš„æ‰©å®¹è¿‡ç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#_1-8hsahmapçš„æ‰©å®¹åŸç†" class="router-link-active router-link-exact-active toc-link level3">1.8HsahMapçš„æ‰©å®¹åŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#hsahmapçš„ä¸å®‰å…¨çš„åŸå› " class="router-link-active router-link-exact-active toc-link level3">HsahMapçš„ä¸å®‰å…¨çš„åŸå› </a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/knowledge/hashmap.html#jdk1-7å¤šçº¿ç¨‹hashmapå¹¶å‘putçš„æ—¶å€™ä¸ºä½•ä¼šå‘ç”Ÿç¯å½¢é“¾è¡¨-äº§ç”Ÿæ­»å¾ªç¯" class="router-link-active router-link-exact-active toc-link level3">JDK1.7å¤šçº¿ç¨‹HashMapå¹¶å‘putçš„æ—¶å€™ä¸ºä½•ä¼šå‘ç”Ÿç¯å½¢é“¾è¡¨ï¼Œäº§ç”Ÿæ­»å¾ªç¯ï¼Ÿ</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="hashmap" tabindex="-1"><a class="header-anchor" href="#hashmap" aria-hidden="true">#</a> HashMap</h1><h2 id="hashmapåŸºç¡€" tabindex="-1"><a class="header-anchor" href="#hashmapåŸºç¡€" aria-hidden="true">#</a> HashMapåŸºç¡€</h2><h3 id="hashmapå­˜å‚¨ç»“æ„" tabindex="-1"><a class="header-anchor" href="#hashmapå­˜å‚¨ç»“æ„" aria-hidden="true">#</a> HashMapå­˜å‚¨ç»“æ„</h3><p>åœ¨JDK1.7ä¸­å’ŒJDK1.8ä¸­æœ‰æ‰€åŒºåˆ«ï¼š åœ¨JDK1.7ä¸­ï¼Œç”±â€æ•°ç»„+é“¾è¡¨â€œç»„æˆï¼Œæ•°ç»„æ˜¯HashMapçš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ã€‚</p><p>åœ¨JDK1.8ä¸­ï¼Œç”±â€œæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘â€ç»„æˆã€‚å½“é“¾è¡¨è¿‡é•¿ï¼Œåˆ™ä¼šä¸¥é‡å½±å“HashMapçš„æ€§èƒ½ï¼Œçº¢é»‘æ ‘æœç´¢æ—¶é—´å¤æ‚åº¦æ˜¯O(logn)ï¼Œè€Œé“¾è¡¨æ˜¯O(n)ã€‚å› æ­¤ï¼ŒJDK1.8å¯¹æ•°æ®ç»“æ„åšäº†è¿›ä¸€æ­¥çš„ä¼˜åŒ–ï¼Œå¼•å…¥äº†çº¢é»‘æ ‘ï¼Œé“¾è¡¨å’Œçº¢é»‘æ ‘åœ¨è¾¾åˆ°ä¸€å®šæ¡ä»¶ä¼šè¿›è¡Œè½¬æ¢ï¼š</p><p>å½“é“¾è¡¨è¶…è¿‡8ä¸”æ•°ç»„é•¿åº¦(æ•°æ®æ€»é‡)è¶…è¿‡64æ‰ä¼šè½¬ä¸ºçº¢é»‘æ ‘ å°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘å‰ä¼šåˆ¤æ–­ï¼Œå¦‚æœå½“å‰æ•°ç»„çš„é•¿åº¦å°äº64ï¼Œé‚£ä¹ˆä¼šé€‰æ‹©å…ˆè¿›è¡Œæ•°ç»„æ‰©å®¹ï¼Œè€Œä¸æ˜¯è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚ ArrayListåº•å±‚æ˜¯åŠ¨æ€æ•°ç»„æ•°æ®ç»“æ„ï¼ŒæŸ¥è¯¢å¿«ï¼Œå¢åˆ æ…¢ï¼ˆå› ä¸ºArrayå¢åˆ éœ€è¦ç§»åŠ¨æ•°æ®ï¼‰ï¼ŒLinkedListåº•å±‚æ˜¯åŒé‡é“¾è¡¨æ•°æ®ç»“æ„ï¼ŒæŸ¥è¯¢ç›¸å¯¹è¾ƒæ…¢ï¼ˆå› ä¸ºLinkæŸ¥è¯¢éœ€è¦ç§»åŠ¨æŒ‡é’ˆï¼‰ï¼Œå¢åˆ å—ã€‚</p><h3 id="hashmapçš„nodeå±æ€§" tabindex="-1"><a class="header-anchor" href="#hashmapçš„nodeå±æ€§" aria-hidden="true">#</a> HashMapçš„nodeå±æ€§</h3><hr><p>HashMapæœ‰ä¸€ä¸ªé‡è¦çš„å±æ€§Node&lt;K,V&gt;,Nodeæ˜¯HashMapçš„ä¸€ä¸ªå†…éƒ¨ç±»å®ç°äº†Entryæ¥å£ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªæ˜ å°„</p><p>Nodeç±»åŸºæœ¬å±æ€§æœ‰ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>hashï¼škeyçš„å“ˆå¸Œå€¼
keyï¼šèŠ‚ç‚¹çš„keyï¼Œç±»å‹å’Œå®šä¹‰<span class="token class-name">HashMap</span>æ—¶çš„keyçš„ç±»å‹ä¸€è‡´
valueï¼šèŠ‚ç‚¹çš„valueï¼Œç±»å‹å’Œå®šä¹‰<span class="token class-name">HashMap</span>æ—¶çš„valueçš„ç±»å‹ä¸€è‡´
nextï¼šè¯¥èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>nextå±æ€§è®°å½•çš„æ˜¯ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æœ¬èº«ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªNodeèŠ‚ç‚¹ï¼Œè¿™ä¸ªNodeèŠ‚ç‚¹ä¹Ÿæœ‰nextå±æ€§ï¼Œä¹Ÿè®°å½•äº†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿™æ ·çš„ä¸€ä¸ªé“¾è¡¨ç»“æ„ï¼Œå¯¹äºä¸€ä¸ªHashMapæ¥è¯´ï¼Œåªéœ€è¦æ˜ç¡®è®°å½•æ¯ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±èƒ½é¡ºåºéå†é“¾è¡¨çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚</p><h3 id="hashmapçš„å®¹é‡" tabindex="-1"><a class="header-anchor" href="#hashmapçš„å®¹é‡" aria-hidden="true">#</a> HashMapçš„å®¹é‡</h3><hr><p>HashMapçš„é»˜è®¤å®¹é‡16</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * The default initial capacity - MUST be a power of two.
 */</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span> <span class="token operator">=</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token comment">//aka 16</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="hashmapçš„è´Ÿè½½å› å­" tabindex="-1"><a class="header-anchor" href="#hashmapçš„è´Ÿè½½å› å­" aria-hidden="true">#</a> HashMapçš„è´Ÿè½½å› å­</h3><hr><p>HahhMapçš„é»˜è®¤åŠ è½½å› å­æ˜¯0.75</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * The load factor used when none specified in constructor.
 */</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">float</span> <span class="token constant">DEFAULT_LOAD_FACTOR</span> <span class="token operator">=</span><span class="token number">0.75</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“HashMapçš„å…ƒç´ è¶…è¿‡å®¹é‡*åŠ è½½å› å­æ—¶ï¼ŒHashMapä¼šè¿›è¡Œæ‰©å®¹</p><h3 id="hashmapçš„hashç®—æ³•" tabindex="-1"><a class="header-anchor" href="#hashmapçš„hashç®—æ³•" aria-hidden="true">#</a> HashMapçš„hashç®—æ³•</h3><hr><p>HashMapçš„hashè¿”å›å€¼ï¼š</p><p>é—®é¢˜ï¼šHashMapâ¾¥â¾¯çš„hash()è¿”å›å€¼ä¸ºä»€ä¹ˆä¸æ˜¯çš„è¿”<code>key.hsahCode()</code>çš„è¿”å›å€¼ï¼Œâ½½æ˜¯<code>key.hsahCode()^(key.hsahCode()&gt;&gt;&gt;16)</code>çš„è¿”å›å€¼å‘¢ï¼Ÿ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> h<span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">(</span>key <span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token number">0</span><span class="token operator">:</span><span class="token punctuation">(</span>h <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>h <span class="token operator">&gt;&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>è¿™æ ·åšçš„ç›®çš„æ˜¯å‡å°‘hashçš„å†²çªæ¦‚ç‡</p></div><p>HashMapåœ¨putçš„æ—¶å€™ï¼Œhashå†²çªæ—¶ä¸å¯é¿å…çš„ï¼Œæ‰€ä»¥å¦‚ä½•å°½é‡é¿å…hashå†²çªï¼Œæˆ–è€…åœ¨hashå†²çªæ—¶å¦‚ä½•å¿«é€Ÿé«˜æ•ˆå®šä½åˆ°æ•°æ®çš„çœŸå®å­˜å‚¨ä½ç½®ï¼Œå°±æ˜¯HashMapä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†key.hsahCode()^(key.hsahCode()&gt;&gt;&gt;16)çš„é€»è¾‘å°±æ˜¯å…ˆè·å¾—keyçš„hashCodeå€¼hï¼Œç„¶åhå’Œhå³ç§»16ä½åšå¼‚æˆ–è¿ç®—ï¼Œè¿™æ ·é«˜16ä¸ºä¹Ÿå‚ä¸åˆ°hashçš„é€»è¾‘è¿ç®—ä¸­äº†ï¼Œå‡å°‘å†²çªã€‚</p><div class="hint-container info"><p class="hint-container-title">ä¾‹</p><p>æ¯”å¦‚æœ‰ä¸¤ä¸ªkeyçš„hashCodeè¿”å›å€¼å¦‚ä¸‹ï¼š</p><p>key1.hashCode()</p><p>1111 1111 1111 1111 0101 0101 0111 0101</p><p>key2.hashCode()</p><p>1111 1111 1110 1111 0101 0101 0111 0101</p><p>å¦‚æœæ²¡æœ‰^(key.hsahCode()&gt;&gt;&gt;16)é‚£ä¹ˆï¼Œ15&amp;hashå°±åˆ†åˆ«æ˜¯</p><p>key1åœ¨åº•å±‚çš„æ•°ç»„ç´¢å¼•å€¼æ˜¯ï¼š5</p><p>1111 1111 1111 1111 0101 0101 0111 0101</p><p>0000 0000 0000 0000 0000 0000 0000 1111</p><p>key2åœ¨åº•å±‚çš„æ•°ç»„ç´¢å¼•å€¼æ˜¯ï¼š5</p><p>1111 1111 1110 1111 0101 0101 0111 0101</p><p>0000 0000 0000 0000 0000 0000 0000 1111</p></div><p>è¿™æ˜¯å› ä¸ºkey1.hashCode()å’Œkey2.hashCode()çš„ä½16ä½å®Œå…¨ç›¸åŒï¼Œç„¶å15&amp;hashçš„æ—¶å€™ï¼Œ15çš„äºŒè¿›åˆ¶00000000000000000000000000001111çš„é«˜ä½å…¨æ˜¯0ï¼Œè¿™å°±é€ æˆäº†15&amp;hashçš„æ—¶å€™ï¼Œåªæœ‰hashçš„ä½16ä¸ºèµ·äº†ä½œç”¨ï¼Œè€Œkey1.hashCode()å’Œkey2.hashCode()çš„ä½16ä½å®Œå…¨ç›¸åŒï¼Œæ‰€ä»¥åº•å±‚ç´¢å¼•å€¼ä¹Ÿç›¸åŒäº†ï¼Œè¿™æ ·å¾ˆå®¹æ˜“é€ æˆhashå†²çªã€‚ä½†å¦‚æœæœ‰^(h &gt;&gt;&gt;16)</p><div class="hint-container info"><p class="hint-container-title">ç›¸å…³ä¿¡æ¯</p><p>æ¯”å¦‚æœ‰ä¸¤ä¸ªkeyçš„hashCodeè¿”å›å€¼å¦‚ä¸‹ï¼š</p><p>å°±æ¯”å¦‚key.hsahCode()ä¹Ÿå°±æ˜¯hçš„å˜é‡å€¼å¦‚ä¸‹ï¼š</p><p>1111 1111 1110 1111 0101 0101 0111 0101</p><p>ç„¶å(h = key.hashCode())^(h &gt;&gt;&gt;16)å°±å˜æˆ</p><p>1111 1111 1110 1111 0101 0101 0111 0101^</p><p>0000 0000 0000 0000 1111 1111 1110 1111</p><p>è®¡ç®—ç»“æœæ˜¯ï¼š1111 1111 1110 1111 1010 1010 1001 1010</p></div><p>è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œæœ€ç»ˆçš„ç»“æœå€¼å…·å¤‡äº†é«˜16ä½ä¸ä½16ä½å…±åŒçš„ç‰¹å¾ï¼Œè¿™æ ·å‡å°‘äº†hashå†²çªçš„æ¦‚ç‡ã€‚</p><h3 id="hashmapçš„æ•°ç»„-é“¾è¡¨-æ ‘" tabindex="-1"><a class="header-anchor" href="#hashmapçš„æ•°ç»„-é“¾è¡¨-æ ‘" aria-hidden="true">#</a> HashMapçš„æ•°ç»„+é“¾è¡¨/æ ‘</h3><hr><p>HashMapä¸ºä»€ä¹ˆè¦å¼•å…¥é“¾è¡¨ï¼Ÿ</p><p>HashMapåº•å±‚æ˜¯æ•°ç»„ï¼Œå½“mapè¿›è¡Œputæ“ä½œçš„æ—¶å€™ï¼Œä¼šè¿›è¡Œhashè®¡ç®—ï¼Œåˆ¤æ–­è¿™ä¸ªå¯¹è±¡å±äºæ•°ç»„çš„å“ªä¸ªä½ç½®ï¼Œå½“å¤šä¸ªå¯¹è±¡åœ¨æ•°ç»„çš„åŒä¸€ä½ç½®æ—¶ï¼Œå°±ä¼šæœ‰hashå†²çªï¼Œè¿™ä¸ªæ—¶å€™å°±å¼•å…¥äº†é“¾è¡¨ã€‚</p><p>ä¸ºä»€ä¹ˆjdk1.8ä¼šå¼•å…¥çº¢é»‘æ ‘ï¼Ÿ</p><p>å½“é“¾è¡¨é•¿åº¦å¤§äº8æ—¶ï¼Œéå†æŸ¥æ‰¾æ•ˆç‡è¾ƒæ…¢ï¼Œæ•…å¼•å…¥çº¢é»‘æ ‘ã€‚å¹¶ä¸æ˜¯åªéœ€è¦é“¾è¡¨é•¿åº¦å¤§äº8 ï¼ŒåŒæ—¶éœ€è¦æ»¡è¶³æ•°ç»„é•¿åº¦å¤§äº64ï¼›è¿˜æœ‰å¦‚æœçº¢é»‘æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°å°äº6æ—¶ï¼Œçº¢é»‘æ ‘ä¼šå˜æˆé“¾è¡¨ã€‚</p><h3 id="hashmapä¸ºä»€ä¹ˆä¸ä¸€å¼€å§‹å°±ä½¿ç”¨çº¢é»‘æ ‘" tabindex="-1"><a class="header-anchor" href="#hashmapä¸ºä»€ä¹ˆä¸ä¸€å¼€å§‹å°±ä½¿ç”¨çº¢é»‘æ ‘" aria-hidden="true">#</a> HashMapä¸ºä»€ä¹ˆä¸ä¸€å¼€å§‹å°±ä½¿ç”¨çº¢é»‘æ ‘</h3><hr><p>è¿™æ˜¯å› ä¸ºçº¢é»‘æ ‘ç»´æŠ¤æˆæœ¬æ¯”è¾ƒå¤§ï¼Œçº¢é»‘æ ‘åœ¨æ’å…¥æ–°æ•°æ®åï¼Œå¯èƒ½ä¼šé€šè¿‡å·¦æ—‹ï¼Œå³æ—‹ï¼Œå˜è‰²æ¥ä¿æŒå¹³è¡¡ï¼Œé€ æˆç»´æŠ¤æˆæœ¬è¿‡é«˜ï¼Œæ•…é“¾è·¯è¾ƒçŸ­æ—¶é‡‡ç”¨é“¾è¡¨ã€‚</p><h3 id="hashmapåº•å±‚æ•°ç»„å–å€¼æ—¶ä¸ºä»€ä¹ˆä¸ç”¨å–æ¨¡è€Œæ˜¯" tabindex="-1"><a class="header-anchor" href="#hashmapåº•å±‚æ•°ç»„å–å€¼æ—¶ä¸ºä»€ä¹ˆä¸ç”¨å–æ¨¡è€Œæ˜¯" aria-hidden="true">#</a> HashMapåº•å±‚æ•°ç»„å–å€¼æ—¶ä¸ºä»€ä¹ˆä¸ç”¨å–æ¨¡è€Œæ˜¯&amp;</h3><hr><p><code>tab[i = (n-1) &amp; hash]</code>,è¿™æ˜¯å› ä¸ºåœ¨è®¡ç®—æœºè¿ç®—æ—¶ï¼Œä½¿ç”¨&amp;æ¯”å–æ¨¡æ€§èƒ½æ›´å¿«ï¼Œ</p><p>æ•°ç»„é•¿åº¦ä¸ºä»€ä¹ˆæ˜¯2çš„æ¬¡å¹‚ã€‚</p><p>æ€»å…±æœ‰3ä¸ªå¥½å¤„ï¼š</p><ul><li>ä¸ºäº†å‡å°‘hashå†²çªï¼Œå°±æ˜¯ä¸ºäº†æ•°æ®å‡åŒ€åˆ†å¸ƒï¼Œæ­¤æ—¶æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨å…¬å¼ï¼ˆhashCode%sizeï¼‰ï¼Œè¿™æ ·å¯ä»¥è¾¾åˆ°æœ€å¤§å¹³å‡åˆ†é…ï¼Œè€Œï¼ˆn-1ï¼‰&amp; hashï¼Œå½“nä¸º2çš„æ¬¡å¹‚æ—¶ï¼Œä¼šæ»¡è¶³ä¸€ä¸ªå…¬å¼ï¼ˆn-1ï¼‰&amp; hash = hash % n</li><li>&amp;çš„è¿ç®—é€Ÿåº¦å¿«ï¼Œæ¯”å–æ¨¡çš„è¿ç®—é€Ÿåº¦æ›´å¿«ï¼Œæ ¹æ®è®¡ç®—javaçš„%ï¼Œ/æ“ä½œæ¯”&amp;æ…¢10å€å·¦å³</li><li>èƒ½ä¿è¯ç´¢å¼•å€¼è‚¯å®šåœ¨capacityä¸­ï¼Œä¸ä¼šè¶…å‡ºæ•°ç»„é•¿åº¦ã€‚</li></ul><h3 id="æŒ‡å®šæ•°ç»„é•¿åº¦ä¸æ˜¯2æ¬¡å¹‚-ä¼šç ´å2æ¬¡å¹‚è§„åˆ™å—" tabindex="-1"><a class="header-anchor" href="#æŒ‡å®šæ•°ç»„é•¿åº¦ä¸æ˜¯2æ¬¡å¹‚-ä¼šç ´å2æ¬¡å¹‚è§„åˆ™å—" aria-hidden="true">#</a> æŒ‡å®šæ•°ç»„é•¿åº¦ä¸æ˜¯2æ¬¡å¹‚ï¼Œä¼šç ´å2æ¬¡å¹‚è§„åˆ™å—</h3><hr><p>ä¸ä¼šçš„ï¼ŒHashMapçš„tableSizeForæ–¹æ³•åšäº†å¤„ç†ï¼Œèƒ½ä¿è¯æ°¸è¿œä¿è¯2æ¬¡å¹‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
* Returns a power of two size for the given target capacity.
*/</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">tableSizeFor</span><span class="token punctuation">(</span><span class="token keyword">int</span> cap<span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token comment">//cap-1 åï¼Œnçš„â¼†è¿›åˆ¶æœ€å³â¼€ä½è‚¯å®šå’Œcapçš„æœ€å³â¼€ä½ä¸åŒï¼Œå³â¼€ä¸ªä¸º0ï¼Œâ¼€ä¸ªä¸º1ï¼Œä¾‹å¦‚cap=17ï¼ˆ00010001ï¼‰ï¼Œn=cap-1=16ï¼ˆ00010000ï¼‰</span>
   <span class="token keyword">int</span> n <span class="token operator">=</span> cap <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token comment">//n = (00010000 | 00001000) = 00011000</span>
   n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span><span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token comment">//n = (00011000 | 00000110) = 00011110</span>
   n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span><span class="token number">2</span><span class="token punctuation">;</span>
   <span class="token comment">//n = (00011110 | 00000001) = 00011111</span>
   n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span><span class="token number">4</span><span class="token punctuation">;</span>
   <span class="token comment">//n = (00011111 | 00000000) = 00011111</span>
   n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span><span class="token number">8</span><span class="token punctuation">;</span>
   <span class="token comment">//n = (00011111 | 00000000) = 00011111</span>
   n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span><span class="token number">16</span><span class="token punctuation">;</span>
   <span class="token comment">//n = 00011111 = 31</span>
   <span class="token comment">//n = 31 + 1 = 32, å³æœ€ç»ˆçš„cap = 32 = 2çš„ (n=5)æ¬¡æ–¹</span>
   <span class="token keyword">return</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">(</span>n <span class="token operator">&gt;=</span> <span class="token constant">MAXIMUM_CAPACITY</span><span class="token punctuation">)</span><span class="token operator">?</span> <span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">:</span> n <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="hashmapæºç " tabindex="-1"><a class="header-anchor" href="#hashmapæºç " aria-hidden="true">#</a> HashMapæºç </h2><h3 id="_1-8çš„putæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1-8çš„putæ–¹æ³•" aria-hidden="true">#</a> 1.8çš„putæ–¹æ³•</h3><ol><li>å¦‚æœkeyå¯¹åº”çš„ç´¢å¼•ä½ç½®æ˜¯çš„å€¼nullï¼Œé‚£ä¹ˆç›´æ¥æ’å…¥</li><li>å¦‚æœkeyå¯¹åº”çš„ç´¢å¼•ä½ç½®çš„æ•°ç»„çš„å€¼ä¸ä¸ºnullï¼Œåˆ¤æ–­è¿™ä¸ªè€å€¼çš„keyå’Œæ–°å€¼çš„keyæ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒå°±æŠŠè€çš„å€¼è¿”å›ï¼Œå¹¶è®°å½•è¿™ä¸ªä½ç½®ã€‚</li><li>å¦‚æœkeyå¯¹åº”çš„ç´¢å¼•ä½ç½®çš„æ•°ç»„çš„å€¼ä¸ä¸ºnullï¼Œåˆ¤æ–­è¿™ä¸ªä½ç½®çš„å€¼æ˜¯ä¸æ˜¯æ ‘ç»“æ„ï¼Œå¦‚æœæ˜¯æ ‘ç»“æ„ï¼Œè°ƒç”¨æ ‘ç»“æ„çš„putTreeValæ–¹æ³•æ·»åŠ æ•°æ®ã€‚</li><li>å¦‚æœkeyå¯¹åº”çš„ç´¢å¼•ä½ç½®çš„æ•°ç»„çš„å€¼ä¸ä¸ºnullï¼Œç„¶åè¿™ä¸ªç´¢å¼•ä½ç½®çš„å€¼å°±æ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„ï¼Œç„¶åéå†æ‰€æœ‰é“¾è¡¨ï¼ˆå½“éå†é•¿åº¦å¤§äº8æ—¶ï¼Œå°±ä¼šè½¬æˆæ ‘ç»“æ„ï¼‰ï¼Œå¦‚æœé“¾è¡¨é‡Œçš„keyå€¼å’Œæ–°keyå€¼ç›¸åŒå°±æŠŠè€çš„å€¼è¿”å›ï¼Œå¹¶è®°å½•è¿™ä¸ªä½ç½®ã€‚å¦‚æœéå†åˆ°å°¾éƒ¨è¿˜ä¸ç›¸åŒï¼Œå°±æ˜¯ç”¨å°¾æ’æ³•æŠŠæ•°æ®æ·»åŠ è¿›å»ã€‚</li></ol><p>å¯¹2æ­¥éª¤å’Œ4æ­¥éª¤è®°å½•çš„ä½ç½®è¿›è¡Œå¤„ç†ï¼Œä¸€æ˜¯æŠŠæ ‡è®°ä½ç½®çš„è€å€¼ç»™è¿”å›ï¼ŒäºŒæ˜¯æŠŠæ–°æ’å…¥çš„å€¼æ”¾åœ¨æ ‡è®°ä½ç½®ä¸Šé¢ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * Implements Map.put and related methods.
 *
 * <span class="token keyword">@param</span> <span class="token parameter">hash</span> hash for key
 * <span class="token keyword">@param</span> <span class="token parameter">key</span> the key
 * <span class="token keyword">@param</span> <span class="token parameter">value</span> the value to put
 * <span class="token keyword">@param</span> <span class="token parameter">onlyIfAbsent</span> if true, don&#39;t change existing value
 * <span class="token keyword">@param</span> <span class="token parameter">evict</span> if false, the table is in creation mode.
 * <span class="token keyword">@return</span> previous value, or null if none
 */</span>
<span class="token keyword">final</span> <span class="token class-name">V</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token keyword">boolean</span> onlyIfAbsent<span class="token punctuation">,</span><span class="token keyword">boolean</span> evict<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> p<span class="token punctuation">;</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> i<span class="token punctuation">;</span>
    <span class="token comment">//tableä¸ºç©ºæˆ–è€…æ²¡æœ‰å…ƒç´ æ—¶ï¼Œåˆ™æ‰©å®¹</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        n <span class="token operator">=</span> <span class="token punctuation">(</span>tab <span class="token operator">=</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token comment">//å¦‚æœé¦–èŠ‚ç‚¹çš„å€¼ä¸ºç©ºï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„é¦–èŠ‚ç‚¹</span>
    <span class="token comment">//æ³¨æ„ï¼ˆn-1ï¼‰&amp; hashæ‰æ˜¯çœŸæ­£çš„hashï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨åœ¨tableä½ç½®çš„indexï¼Œ</span>
    <span class="token comment">//åœ¨1.6ä¸­æ˜¯å°è£…æˆindexForå‡½æ•°</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">=</span> tab<span class="token punctuation">[</span>i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        tab<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment">//åˆ°è¿™å°±è¯´æ˜ç¢°æ’äº†ï¼Œå°±è¦å¤„ç†ç¢°æ’</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> e<span class="token punctuation">;</span> <span class="token class-name">K</span> k<span class="token punctuation">;</span>
        <span class="token comment">//å¦‚æœåœ¨é¦–èŠ‚ç‚¹ï¼Œä¸æˆ‘ä»¬å¾…æ’å…¥çš„å…ƒç´ æœ‰ç›¸åŒçš„hashå’Œkeyå€¼ï¼Œåˆ™å…ˆè®°å½•</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            e <span class="token operator">=</span> p<span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span><span class="token comment">//å¦‚æœé¦–èŠ‚ç‚¹æ˜¯çº¢é»‘æ ‘ç±»å‹ï¼Œåˆ™å…ˆæŒ‰ç…§çº¢é»‘æ ‘æ–¹æ³•æ·»åŠ è¯¥å…ƒç´ </span>
            e <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">putTreeVal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> tab<span class="token punctuation">,</span> hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment">//åˆ°è¿™ä¸€æ­¥è¯´æ˜é¦–èŠ‚ç‚¹ä¸ºé“¾è¡¨ç±»å‹</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> binCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token operator">++</span>binCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//å¦‚æœéå†åˆ°æœ«å°¾æ—¶ï¼Œç°åœ¨æœ«å°¾è¿½åŠ è¯¥å…ƒç´ èŠ‚ç‚¹</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    p<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">//å½“éå†èŠ‚ç‚¹æ•°ç›®å¤§äº8æ—¶ï¼Œé‡‡å–æ ‘è¯ç»“æ„</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>binCount <span class="token operator">&gt;=</span> <span class="token constant">TREEIFY_THRESHOLD</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// -1 for 1st</span>
                        <span class="token function">treeifyBin</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">//å¦‚æœæ‰¾åˆ°ä¸æˆ‘ä»¬å¾…æ’å…¥å…ƒç´ å…·æœ‰ç›¸åŒçš„hashå’Œkeyå€¼çš„èŠ‚ç‚¹ï¼Œåˆ™åœæ­¢éå†ï¼Œæ­¤æ—¶eå·²ç»è®°å½•äº†è¯¥èŠ‚ç‚¹</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                p <span class="token operator">=</span> e<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//è¡¨ç¤ºè®°å½•åˆ°å…·æœ‰ç›¸åŒå…ƒç´ çš„èŠ‚ç‚¹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// existing mapping for key</span>
            <span class="token class-name">V</span> oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            <span class="token comment">//onlyIfAbsentè¡¨ç¤ºå¦‚æœå½“å‰ä½ç½®å·²å­˜åœ¨ä¸€ä¸ªå€¼ï¼Œæ˜¯å¦æ›¿æ¢ï¼Œfalseæ˜¯æ›¿æ¢ï¼Œtrueæ˜¯ä¸æ›¿æ¢</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>onlyIfAbsent <span class="token operator">||</span> oldValue <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
            <span class="token function">afterNodeAccess</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¿™æ˜¯ä¸€ä¸ªç©ºå‡½æ•°å¯ä»¥æ ¹æ®ç”¨æˆ·éœ€è¦è¦†ç›–</span>
            <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token operator">++</span>modCount<span class="token punctuation">;</span>
    <span class="token comment">//å½“èŠ‚ç‚¹æ•°+1å¤§äºthresholdæ—¶æ‰©å®¹</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>size <span class="token operator">&gt;</span> threshold<span class="token punctuation">)</span>
        <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">afterNodeInsertion</span><span class="token punctuation">(</span>evict<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¿™æ˜¯ä¸€ä¸ªç©ºå‡½æ•°å¯ä»¥æ ¹æ®ç”¨æˆ·éœ€è¦è¦†ç›–</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>HashMapåœ¨put()æ—¶,å¦‚æœputä¸€ä¸ªå·²ç»å­˜åœ¨çš„keyï¼Œé‚£ä¹ˆä¼šæŠŠè€çš„keyå¯¹åº”çš„å€¼è¿”å›</p><h3 id="_1-8çš„getæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1-8çš„getæ–¹æ³•" aria-hidden="true">#</a> 1.8çš„getæ–¹æ³•</h3><hr><ol><li>é¦–å…ˆè·å–å½“å‰keyå¯¹åº”çš„æ•°ç»„ç´¢å¼•ä½ç½®ï¼Œç„¶ååˆ¤æ–­è¯¥ä½ç½®çš„é¦–èŠ‚ç‚¹æ˜¯å¦æ˜¯è‡ªå·±æƒ³è¦çš„å€¼ï¼Œæ ¹æ®keyå’Œkey.hashCode()æ¥åˆ¤æ–­</li><li>é¦–èŠ‚ç‚¹å¦‚æœä¸æ˜¯çš„è¯ï¼Œåˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦æ˜¯æ ‘èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œè°ƒç”¨getTreeNode()æ¥å®ç°get()æ–¹æ³•ï¼Œå¦‚æœä¸æ˜¯æ ‘èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°±æ˜¯é“¾è¡¨ï¼Œç„¶åæ­»å¾ªç¯éå†é“¾è¡¨ï¼ŒæŸ¥è¯¢æ˜¯å¦æœ‰è‡ªå·±æƒ³è¦çš„å€¼</li></ol><p>å¦‚æœä¸Šé¢çš„æ­¥éª¤éƒ½æ²¡æœ‰æŸ¥è¯¢åˆ°æ•°æ®ï¼Œç›´æ¥è¿”å›null</p><p>åº•å±‚æºç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">V</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//å®šä¹‰ä¸€ä¸ªnodeå¯¹è±¡æ¥æ¥æ”¶</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> e<span class="token punctuation">;</span>
    <span class="token comment">//è°ƒç”¨getNode()æ–¹æ³•ï¼Œè¿”å›å€¼èµ‹ç»™eï¼Œå¦‚æœå–å¾—å€¼ä¸ºnullï¼Œå°±è¿”å›nullï¼Œå¦åˆ™å°±è¿”å›nodeå¯¹è±¡eçš„valueå€¼</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>e <span class="token operator">=</span> <span class="token function">getNode</span><span class="token punctuation">(</span><span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//å–hashå€¼æ–¹æ³•ï¼ŒHahsMapçš„putæ–¹æ³•ä¹Ÿæ˜¯è°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•ï¼Œgetæ–¹æ³•ä¹Ÿè°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•ä¿è¯å­˜å–æ—¶keyå¯¹åº”çš„hashå€¼æ˜¯ä¸€è‡´çš„ï¼Œè¿™æ ·æ‰èƒ½æ­£ç¡®å¯¹åº”</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> h<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">final</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token function">getNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//å®šä¹‰å‡ ä¸ªå˜é‡</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> first<span class="token punctuation">,</span> e<span class="token punctuation">;</span> <span class="token keyword">int</span> n<span class="token punctuation">;</span> <span class="token class-name">K</span> k<span class="token punctuation">;</span>
    <span class="token comment">//é¦–å…ˆåˆ¤æ–­æ•°ç»„çš„tableä¸èƒ½ä¸ºç©ºï¼Œä¸”é•¿åº¦è¦å¤§äº0ï¼ŒåŒæ—¶æŠŠæ•°ç»„é•¿åº¦tab.lengthèµ‹ç»™n</span>
    <span class="token comment">//å…¶æ¬¡æ˜¯é€šè¿‡ï¼ˆn-1ï¼‰&amp; hashè·å–keyå¯¹åº”çš„ç´¢å¼•ï¼ŒåŒæ—¶æ•°ç»„ä¸­è¿™ä¸ªç´¢å¼•è¦æœ‰å€¼ï¼Œç„¶åèµ‹å€¼ç»™firstå˜é‡</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>first <span class="token operator">=</span> tab<span class="token punctuation">[</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//è¿™ä¸ªfirstå…¶å®å°±æ˜¯é“¾è¡¨çš„å¤´èŠ‚ç‚¹äº†ï¼Œæ¥ä¸‹æ¥åˆ¤æ–­firstçš„hashå€¼æ˜¯å¦ç­‰äºä¼ è¿‡æ¥keyçš„hashå€¼ã€‚</span>
        <span class="token comment">// always check first node</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>first<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> first<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment">//å¦‚æœæ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„è¯ï¼Œè¯´æ˜è¦æ‰¾çš„å°±æ˜¯firstèŠ‚ç‚¹ï¼Œç›´æ¥è¿”å›</span>
            <span class="token keyword">return</span> first<span class="token punctuation">;</span>
        <span class="token comment">//èµ°åˆ°è¿™ä¸€æ­¥ï¼Œå°±è¯´æ˜è¦æ‰¾çš„èŠ‚ç‚¹ä¸æ˜¯é¦–èŠ‚ç‚¹ï¼Œé‚£å°±ç”¨first.nextæ‰¾ä»–çš„åç»§èŠ‚ç‚¹ï¼Œå¹¶èµ‹å€¼ç»™eå˜é‡ï¼Œåœ¨è¿™ä¸ªå˜é‡ä¸ä¸ºç©ºæ—¶</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> first<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//å¦‚æœé¦–èŠ‚ç‚¹æ˜¯æ ‘ç±»å‹çš„ï¼Œé‚£å°±ç”¨getTreeNode()å»æ ‘é‡Œå¯»æ‰¾</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>first <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
                <span class="token comment">//è·å–æ ‘ä¸­å¯¹åº”keyèŠ‚ç‚¹ç›´æ¥è¿”å›</span>
                <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>first<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTreeNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//èµ°åˆ°è¿™ä¸€æ­¥è¯´æ˜ç»“æ„è¿˜æ˜¯é“¾è¡¨</span>
            <span class="token keyword">do</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> e<span class="token punctuation">;</span>
            <span class="token comment">//è·å–eèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ï¼Œèµ‹å€¼ç»™eï¼Œä¸ä¸ºç©ºè¿›å…¥å¾ªç¯ä½“</span>
            <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//ä»¥ä¸Šæ¡ä»¶éƒ½ä¸æ»¡è¶³è¯´æ˜æ²¡æœ‰è¯¥keyå¯¹åº”çš„æ•°æ®èŠ‚ç‚¹ï¼Œè¿”å›null</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-7hashmapçš„æ‰©å®¹åŸç†" tabindex="-1"><a class="header-anchor" href="#_1-7hashmapçš„æ‰©å®¹åŸç†" aria-hidden="true">#</a> 1.7HashMapçš„æ‰©å®¹åŸç†</h3><hr><p>1.7çš„æ‰©å®¹åŸç†ï¼Œä»€ä¹ˆæ—¶å€™æ‰©å®¹å’Œæ‰©å®¹å¤šå°‘ï¼Œ1.7çš„æ‰©å®¹ä»putæ–¹æ³•ä½œä¸ºå…¥å£è®²è§£ï¼Œput(K,V)æ“ä½œï¼Ÿ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">V</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">,</span><span class="token class-name">V</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>key<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">putForNullKey</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> hash <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®¡ç®—keyçš„hashå€¼</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span>table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é€šè¿‡hashå€¼å¯¹åº”åˆ°æ¡¶çš„ä½ç½®</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> e <span class="token operator">=</span> table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//é¡ºåºéå†æ¡¶å¤–æŒ‚çš„å•é“¾è¡¨</span>
        <span class="token class-name">Object</span> k<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">K</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//æ³¨æ„è¿™é‡Œçš„å¥çš„æ¯”è¾ƒæ–¹å¼==æˆ–è€…equals</span>
            <span class="token class-name">V</span> oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
            e<span class="token punctuation">.</span><span class="token function">recordAccess</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    modCount<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token comment">//éå†å•é“¾è¡¨å®Œæ¯•ï¼Œæ²¡æœ‰æ‰¾åˆ°ä¸å¥ç›¸å¯¹åº”çš„Entryï¼Œéœ€è¦æ–°å»ºä¸€ä¸ªEntryæ¢å¥è¯è¯´æ¡¶iæ˜¯ä¸€ä¸ªç©ºæ¡¶</span>
    <span class="token function">addEntry</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span>key<span class="token punctuation">,</span>value<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ—¢ç„¶æ‰¾åˆ°ä¸€ä¸ªç©ºæ¡¶ï¼Œé‚£ä¹ˆæ–°å»ºçš„Entryå¿…å®šæ˜¯è¿™ä¸ªæ¡¶å¤–æŒ‚å•é“¾è¡¨çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé€šè¿‡addEntryï¼Œæ‰¾åˆ°äº†æ‰©å®¹çš„æ—¶æœº</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">addEntry</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span><span class="token class-name">K</span> key<span class="token punctuation">,</span><span class="token class-name">V</span> value<span class="token punctuation">,</span><span class="token keyword">int</span> bucketIndex<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//sizeè®°å½•çš„æ˜¯mapä¸­åŒ…å«entryçš„å«é‡</span>
    <span class="token comment">//thresholdè®°å½•çš„æ˜¯éœ€è¦resizeçš„é˜™å€¼ï¼Œä¸”threshold=loadFactor*capacity</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>size <span class="token operator">&gt;=</span> threshold<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//å½“sizeå¤§äºç­‰äºæŸä¸ªé˜™å€¼thresholdçš„æ—¶å€™ä¸”è¯¥æ¡¶å¹¶ä¸æ˜¯ä¸€ä¸ªç©ºæ¡¶</span>
        <span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°†å®¹é‡æ‰©å®¹ä¸ºåŸæ¥çš„ä¸¤å€</span>
        hash <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">null</span><span class="token operator">!=</span>key<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bucketIndex <span class="token operator">=</span> <span class="token function">indexFox</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span>table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ‰©å®¹åï¼Œè¯¥hashå€¼å¯¹åº”çš„æ–°çš„æ¡¶çš„ä½ç½®</span>
    <span class="token punctuation">}</span>
    <span class="token function">createEntry</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span>key<span class="token punctuation">,</span>value<span class="token punctuation">,</span>bucketIndex<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åœ¨æŒ‡å®šæ¡¶çš„ä½ç½®åˆ›å»ºä¸€ä¸ªæ–°çš„Entry</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">createEntry</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span><span class="token class-name">K</span> key<span class="token punctuation">,</span><span class="token class-name">V</span> value<span class="token punctuation">,</span><span class="token keyword">int</span> bucketIndex<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> e <span class="token operator">=</span> table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span>key<span class="token punctuation">,</span>value<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é“¾è¡¨çš„å¤´æ’æ³•æ’å…¥æ–°å»ºçš„Entry</span>
    <span class="token comment">//sizeè®°å½•çš„æ˜¯mapä¸­åŒ…å«entryçš„å«é‡</span>
    size<span class="token operator">++</span>ï¼›<span class="token comment">//æ›´æ–°size</span>
<span class="token punctuation">}</span>


<span class="token comment">//capacityå…¶å®å°±æ˜¯æ¡¶çš„é•¿</span>
threshold<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>newCapacity<span class="token operator">*</span>loadFactor<span class="token punctuation">,</span><span class="token constant">MAXIMUM_CAPACITY</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å› æ­¤ç°åœ¨æ€»ç»“å‡ºæ‰©å®¹çš„æ—¶æœºï¼š</p><p>å½“mapä¸­åŒ…å«çš„Entryçš„æ•°é‡å¤§äºç­‰äºthreshold=loadFactor*capacityçš„æ—¶å€™ï¼Œä¸”æ–°å»ºçš„Entryåˆšå¥½è½åœ¨ä¸€ä¸ªéç©ºçš„æ¡¶ä¸Šï¼Œæ­¤åˆ»è§¦å‘æ‰©å®¹æœºåˆ¶ï¼Œå°†å…¶å®¹é‡æ‰©å¤§ä¸º2å€ã€‚</p><p>è¿™ä¸ªè¿™æ ·è¯´æ˜æ¯”è¾ƒå¥½ç†è§£ï¼šå› ä¸ºsizeå·²ç»å¤§äºç­‰äºé˜™å€¼äº†ï¼Œè¯´æ˜Entryæ•°é‡è¾ƒå¤šï¼Œhashå†²çªä¸¥é‡ï¼Œé‚£ä¹ˆè‹¥è¯¥Entryå¯¹åº”çš„æ¡¶ä¸æ˜¯ä¸€ä¸ªç©ºæ¡¶ï¼Œè¿™ä¸ªEntryçš„åŠ å…¥å¿…ç„¶ä¼šæŠŠåŸæ¥çš„é“¾è¡¨æ‹‰çš„æ›´é•¿å› æ­¤éœ€è¦æ‰©å®¹ï¼›è‹¥å¯¹åº”çš„æ¡¶æ˜¯ä¸€ä¸ªç©ºæ¡¶ï¼Œé‚£ä¹ˆæ­¤æ—¶æ²¡æœ‰å¿…è¦æ‰©å®¹ã€‚</p><div class="hint-container danger"><p class="hint-container-title">é‡è¦</p><p>å½“sizeå¤§äºç­‰äºthresholdçš„æ—¶å€™ï¼Œå¹¶ä¸ä¸€å®šä¼šè§¦å‘æ‰©å®¹æœºåˆ¶ï¼Œä½†æ˜¯ä¼šå¾ˆå¯èƒ½è§¦å‘æ‰©å®¹æœºåˆ¶ï¼Œåªè¦æœ‰ä¸€ä¸ªæ–°å»ºçš„Entryå‡ºç°å“ˆå¸Œå†²çªï¼Œåˆ™ç«‹åˆ»resizeã€‚</p></div><h3 id="_1-7hashmapçš„æ‰©å®¹è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#_1-7hashmapçš„æ‰©å®¹è¿‡ç¨‹" aria-hidden="true">#</a> 1.7HashMapçš„æ‰©å®¹è¿‡ç¨‹</h3><hr><p>ä¸Šé¢æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ–¹æ³•ï¼ŒåŒ…å«äº†å‡ ä¹å±äºçš„æ‰©å®¹è¿‡ç¨‹ï¼Œå°±æ˜¯resize()ï¼›</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token keyword">int</span> newCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> oldTable <span class="token operator">=</span> table<span class="token punctuation">;</span>
    <span class="token keyword">int</span> oldCapacity <span class="token operator">=</span> oldTable<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCapacity <span class="token operator">==</span> <span class="token constant">MAXIMUM_CAPACITY</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//æœ€å¤§å®¹é‡ä¸º1&lt;&lt;30</span>
        threshold <span class="token operator">=</span> lnteger<span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span>newCapacity<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//æ–°å»ºä¸€ä¸ªæ–°è¡¨</span>
    <span class="token keyword">boolean</span> oldAltHashing <span class="token operator">=</span> useAltHashing<span class="token punctuation">;</span>
    useAltHashing <span class="token operator">|=</span> sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span><span class="token constant">VM</span><span class="token punctuation">.</span><span class="token function">isBooted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">&gt;=</span> <span class="token class-name">Holder</span><span class="token punctuation">.</span><span class="token constant">ALTERNATIVE_HASHING_THRESHOLD</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> rehash <span class="token operator">=</span> oldAltHashing <span class="token operator">^</span> useAltHashing<span class="token punctuation">;</span><span class="token comment">//æ˜¯å¦å†hash</span>
    <span class="token function">transfer</span><span class="token punctuation">(</span>newTable<span class="token punctuation">,</span> rehash<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å®Œæˆæ—§è¡¨åˆ°æ–°è¡¨çš„è½¬ç§»</span>
    table <span class="token operator">=</span> newTable<span class="token punctuation">;</span>
    threshold <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>newCapacity <span class="token operator">*</span> loadFactor<span class="token punctuation">,</span><span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTable<span class="token punctuation">,</span> <span class="token keyword">boolean</span> rehash<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> newTable<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> e <span class="token operator">:</span> table<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//éå†åŒæ¡¶æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªæ¡¶</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//é¡ºåºéå†æŸä¸ªæ¡¶çš„å¤–æŒ‚é“¾è¡¨</span>
            <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span> <span class="token comment">//å¼•ç”¨next</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>rehash<span class="token punctuation">)</span><span class="token punctuation">{</span>
                e<span class="token punctuation">.</span>hash <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token operator">==</span> e<span class="token punctuation">.</span>key <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token function">hash</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ‰¾åˆ°æ–°è¡¨çš„æ¡¶ä½ç½® ;åŸæ¡¶æ•°ç»„ä¸­çš„æŸä¸ªæ¡¶ä¸Šçš„åŒä¸€é“¾è¡¨ä¸­çš„Entryæ­¤åˆ»å¯èƒ½è¢«åˆ†æ•£åˆ°ä¸åŒçš„æ¡¶ä¸­å»äº†ï¼Œæœ‰æ•ˆçš„ç¼“è§£äº†å“ˆå¸Œå†²çª</span>
            e<span class="token punctuation">.</span>next <span class="token operator">=</span> newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//å¤´æ’æ³•æ’å…¥æ–°è¡¨ä¸­</span>
            newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
            e <span class="token operator">=</span> next<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹äºresizeçš„è¿‡ç¨‹ï¼Œç›¸å¯¹æ¥è¯´æ˜¯æ¯”è¾ƒç®€å•æ¸…æ™°æ˜“äºç†è§£çš„ï¼Œæ—§æ¡¶æ•°ç»„ä¸­çš„æŸä¸ªæ¡¶çš„å¤–æŒ‚å•é“¾è¡¨æ˜¯é€šè¿‡å¤´æ’æ³•ï¼Œæ’å…¥æ–°æ¡¶æ•°ç»„ä¸­çš„ï¼Œå¹¶ä¸”åŸé“¾è¡¨çš„EntryèŠ‚ç‚¹å¹¶ä¸ä¸€å®šåœ¨æ–°æ¡¶æ•°ç»„çš„åŒä¸€é“¾è¡¨</p><p>è¿™å¾ˆå®¹æ˜“å°±æƒ³åˆ°åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªtransferæ–¹æ³•åœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸‹ä¼šä¹±å¥—ï¼Œäº‹å®ä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œç”±äºç¼ºä¹åŒæ­¥æœºåˆ¶ï¼Œå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶resizeæ—¶ï¼Œå½“æŸä¸ªçº¿ç¨‹tæ‰€æŒæœ‰çš„å¼•ç”¨nextï¼ˆå‚è€ƒä¸Šé¢ä»£ç nextæŒ‡å‘æºæ¡¶æ•°ç»„ä¸­æŸä¸ªæ¡¶å¤–æŒ‚å•é“¾è¡¨ä¸‹ä¸€ä¸ªéœ€è¦è½¬ç§»çš„Entryï¼‰ï¼Œå¯èƒ½å·²ç»è¢«è½¬ç§»åˆ°äº†æ–°æ¡¶æ•°ç»„ä¸­ï¼Œé‚£ä¹ˆæœ€åè¯¥çº¿ç¨‹tå®é™…ä¸Šåœ¨å¯¹æ–°çš„æ¡¶æ•°ç»„è¿›è¡Œtransferæ“ä½œã€‚</p><p>å¦‚æœæœ‰æ›´å¤šçš„çº¿ç¨‹å‡ºç°è¿™ç§æƒ…å†µï¼Œé‚£å¾ˆå¯èƒ½ä¼šå‡ºç°å¤§é‡çº¿ç¨‹éƒ½åœ¨å¯¹æ–°æ¡¶æ•°ç»„è¿›è¡Œtransferï¼Œè¿™æ ·ææ˜“é€ æˆæ­»å¾ªç¯ï¼Œæ•°æ®ä¸¢å¤±ç­‰ç­‰ï¼Œå› æ­¤HashMapä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥è€ƒè™‘åœ¨å¤šçº¿ç¨‹å¹¶å‘ç¯å¢ƒä¸‹ä½¿ç”¨å¹¶å‘å·¥å…·åŒ…ä¸‹çš„ConcurrentHashMapã€‚</p><h3 id="_1-8hsahmapçš„æ‰©å®¹åŸç†" tabindex="-1"><a class="header-anchor" href="#_1-8hsahmapçš„æ‰©å®¹åŸç†" aria-hidden="true">#</a> 1.8HsahMapçš„æ‰©å®¹åŸç†</h3><hr><p>JDK1.8å¯¹resize()æ–¹æ³•è¿›è¡Œäº†å¾ˆå¤§çš„è°ƒæ•´ï¼ŒJDK1.8çš„resize()æ–¹æ³•å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> oldTab <span class="token operator">=</span> table<span class="token punctuation">;</span>
    <span class="token keyword">int</span> oldCap <span class="token operator">=</span> <span class="token punctuation">(</span>oldTab <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> oldTab<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token comment">//å®šä¹‰oldCapå‚æ•°ï¼Œè®°å½•äº†tableé•¿åº¦</span>
    <span class="token keyword">int</span> oldThr <span class="token operator">=</span> threshold<span class="token punctuation">;</span>
    <span class="token keyword">int</span> newCap<span class="token punctuation">,</span> newThr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//å®šä¹‰äº†newCapå‚æ•°ï¼Œè®°å½•äº†æ–°tableé•¿åº¦</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">&gt;=</span> <span class="token constant">MAXIMUM_CAPACITY</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            threshold <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> oldTab<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>newCap <span class="token operator">=</span> oldCap <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">&amp;&amp;</span> oldCap <span class="token operator">&gt;=</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span><span class="token punctuation">)</span>
            newThr <span class="token operator">=</span> oldThr <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// double threshold //æ‰©å®¹newCapæ—¶oldCapé•¿åº¦çš„2å€</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldThr <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// initial capacity was placed in threshold</span>
        newCap <span class="token operator">=</span> oldThr<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>               <span class="token comment">// zero initial threshold signifies using defaults</span>
        newCap <span class="token operator">=</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span><span class="token punctuation">;</span>
        newThr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_LOAD_FACTOR</span> <span class="token operator">*</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newThr <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">float</span> ft <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>newCap <span class="token operator">*</span> loadFactor<span class="token punctuation">;</span>
        newThr <span class="token operator">=</span> <span class="token punctuation">(</span>newCap <span class="token operator">&lt;</span> <span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">&amp;&amp;</span> ft <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>ft <span class="token operator">:</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    threshold <span class="token operator">=</span> newThr<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;rawtypes&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTab <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>newCap<span class="token punctuation">]</span><span class="token punctuation">;</span>
    table <span class="token operator">=</span> newTab<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldTab <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> oldCap<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å¾ªç¯åŸtableï¼ŒæŠŠåŸtableä¸­çš„æ¯ä¸ªé“¾è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ æ”¾å…¥æ–°table</span>
            <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> e<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>next <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token comment">//æŒ‡çš„æ˜¯é“¾è¡¨ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥ç›´æ¥å§eæ”¾å…¥æ–°tableï¼Œå…¶ä¸­e.hash&amp;(newCap-1)å°±æ˜¯è®¡ç®—eåœ¨æ–°tableä¸­çš„ä½ç½®ï¼Œå’ŒJDK1.7ä¸­indexFor()ä½œç”¨ä¸€è‡´</span>
                    newTab<span class="token punctuation">[</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> <span class="token punctuation">(</span>newCap <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> newTab<span class="token punctuation">,</span> j<span class="token punctuation">,</span> oldCap<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// preserve order</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> loHead <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> loTail <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> hiHead <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> hiTail <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> next<span class="token punctuation">;</span>
                    <span class="token keyword">do</span> <span class="token punctuation">{</span>
                        next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> oldCap<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                                loHead <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            <span class="token keyword">else</span>
                                loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            loTail <span class="token operator">=</span> e<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span> <span class="token punctuation">{</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                                hiHead <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            <span class="token keyword">else</span>
                                hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            hiTail <span class="token operator">=</span> e<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                        newTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> loHead<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                        newTab<span class="token punctuation">[</span>j <span class="token operator">+</span> oldCap<span class="token punctuation">]</span> <span class="token operator">=</span> hiHead<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> newTab<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="hsahmapçš„ä¸å®‰å…¨çš„åŸå› " tabindex="-1"><a class="header-anchor" href="#hsahmapçš„ä¸å®‰å…¨çš„åŸå› " aria-hidden="true">#</a> HsahMapçš„ä¸å®‰å…¨çš„åŸå› </h3><hr><p>å¤šçº¿ç¨‹putçš„æ—¶å€™å¯èƒ½ä¼šé€ æˆæ•°æ®ä¸¢å¤±</p><p>putæ–¹æ³•çš„æºç </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">V</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">final</span> <span class="token class-name">V</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token keyword">boolean</span> onlyIfAbsent<span class="token punctuation">,</span> <span class="token keyword">boolean</span> evict<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> p<span class="token punctuation">;</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> i<span class="token punctuation">;</span>
    <span class="token comment">//åˆå§‹åŒ–hashè¡¨</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        n <span class="token operator">=</span> <span class="token punctuation">(</span>tab <span class="token operator">=</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token comment">//é€šè¿‡hashå€¼è®¡ç®—åœ¨hashè¡¨ä¸­çš„ä½ç½®ï¼Œå¹¶å°†è¿™ä¸ªä½ç½®ä¸Šçš„å…ƒç´ èµ‹å€¼ç»™Pï¼Œå¦‚æœæ˜¯ç©ºçš„åˆ™newä¸€ä¸ªæ–°çš„nodeæ”¾åœ¨è¿™ä¸ªä½ç½®ä¸Š</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">=</span> tab<span class="token punctuation">[</span>i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        tab<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">//hashè¡¨çš„å½“å‰indexå·²ç»å­˜åœ¨å…ƒç´ ï¼Œå‘è¿™ä¸ªå…ƒç´ åè¿½åŠ é“¾è¡¨</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> e<span class="token punctuation">;</span> <span class="token class-name">K</span> k<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            e <span class="token operator">=</span> p<span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
            e <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">putTreeVal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> tab<span class="token punctuation">,</span> hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> binCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token operator">++</span>binCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//æ–°å»ºèŠ‚ç‚¹å¹¶è¿½åŠ åˆ°é“¾è¡¨</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//#1</span>
                    p<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//#2</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>binCount <span class="token operator">&gt;=</span> <span class="token constant">TREEIFY_THRESHOLD</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// -1 for 1st</span>
                        <span class="token function">treeifyBin</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                p <span class="token operator">=</span> e<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// existing mapping for key</span>
            <span class="token class-name">V</span> oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>onlyIfAbsent <span class="token operator">||</span> oldValue <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
            <span class="token function">afterNodeAccess</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token operator">++</span>modCount<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>size <span class="token operator">&gt;</span> threshold<span class="token punctuation">)</span>
        <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">afterNodeInsertion</span><span class="token punctuation">(</span>evict<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‡è®¾t1å’Œt2åŒäº‹æ‰§è¡Œputï¼Œå‡è®¾t1æ‰§è¡Œput(k2,v2),t2æ‰§è¡Œput(k3,v3)ï¼Œå¹¶ä¸”k2ä¸k3çš„hashå€¼ä¸å›¾ä¸­çš„k1ç›¸åŒï¼Œé‚£ä¹ˆæ­£å¸¸æƒ…å†µä¸‹ï¼Œputå®Œæˆä¹‹åï¼Œtableçš„çŠ¶æ€åº”è¯¥æ˜¯ä¸‹å›¾äºŒè€…å…¶ä¸€</p><figure><img src="/assets/images/hashmap01.png" alt="t1,t2" tabindex="0" loading="lazy"><figcaption>t1,t2</figcaption></figure><p>æˆ–è€…</p><figure><img src="/assets/images/hashmap02.png" alt="t2,t1" tabindex="0" loading="lazy"><figcaption>t2,t1</figcaption></figure><p>å‡è®¾çº¿ç¨‹1ï¼Œçº¿ç¨‹2ç°åœ¨éƒ½æ‰§è¡Œåˆ°putæºç ä¸­çš„#1ä½ç½®ï¼Œä¸”å½“å‰tableçŠ¶æ€å¦‚ä¸‹</p><figure><img src="/assets/images/hashmap03.png" alt="#1" tabindex="0" loading="lazy"><figcaption>#1</figcaption></figure><p>ç„¶åä¸¤ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œäº†if((e = p.next)==null)è¿™å¥ä»£ç ï¼Œæ¥åˆ°äº†#2è¿™è¡Œä»£ç </p><p>æ­¤æ—¶å‡è®¾t1å…ˆæ‰§è¡Œp.next=newNode(hash,key,value,null);é‚£ä¹ˆtableä¼šå˜æˆå¦‚ä¸‹çŠ¶æ€</p><figure><img src="/assets/images/hashmap04.png" alt="t1" tabindex="0" loading="lazy"><figcaption>t1</figcaption></figure><p>ç´§æ¥ç€t2æ‰§è¡Œp.next=newNode(hash,key,value,null);æ­¤æ—¶tableä¼šå˜æˆå¦‚ä¸‹çŠ¶æ€</p><figure><img src="/assets/images/hashmap05.png" alt="t2" tabindex="0" loading="lazy"><figcaption>t2</figcaption></figure><p>è¿™æ ·ä¸€æ¥ï¼Œkey2å…ƒç´ å°±ä¸¢äº†</p><hr><p>å¤šçº¿ç¨‹putå’Œgetå¹¶å‘çš„æ—¶å€™ï¼Œå¯èƒ½é€ æˆgetä¸ºnull</p><p>çº¿ç¨‹1æ‰§è¡Œputæ—¶ï¼Œå› ä¸ºå…ƒç´ éš”å®¿è¶…å‡ºthresholdè€Œå¯¼è‡´rehashï¼Œçº¿ç¨‹2æ­¤æ—¶æ‰§è¡Œgetï¼Œæœ‰å¯èƒ½å¯¼è‡´è¿™ä¸ªé—®é¢˜</p><p>å…ˆçœ‹ä¸‹resizeæ–¹æ³•æºç </p><p>å¤§è‡´çš„æ„æ€æ˜¯ï¼Œå…ˆè®¡ç®—æ–°çš„å®¹é‡å’Œthresholdï¼Œåœ¨åˆ›å»ºä¸€ä¸ªæ–°çš„hashè¡¨ï¼Œæœ€åå°†æ—§hashè¡¨ä¸­å…ƒç´ rehashåˆ°æ–°çš„hashè¡¨ä¸­</p><p>é‡ç‚¹ä»£ç åœ¨äº#1å’Œ#2ä¸¤å¥</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> oldTab <span class="token operator">=</span> table<span class="token punctuation">;</span>
    <span class="token keyword">int</span> oldCap <span class="token operator">=</span> <span class="token punctuation">(</span>oldTab <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> oldTab<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token comment">//å®šä¹‰oldCapå‚æ•°ï¼Œè®°å½•äº†tableé•¿åº¦</span>
    <span class="token keyword">int</span> oldThr <span class="token operator">=</span> threshold<span class="token punctuation">;</span>
    <span class="token keyword">int</span> newCap<span class="token punctuation">,</span> newThr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//å®šä¹‰äº†newCapå‚æ•°ï¼Œè®°å½•äº†æ–°tableé•¿åº¦</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">&gt;=</span> <span class="token constant">MAXIMUM_CAPACITY</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            threshold <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> oldTab<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>newCap <span class="token operator">=</span> oldCap <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">&amp;&amp;</span> oldCap <span class="token operator">&gt;=</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span><span class="token punctuation">)</span>
            newThr <span class="token operator">=</span> oldThr <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// double threshold //æ‰©å®¹newCapæ—¶oldCapé•¿åº¦çš„2å€</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldThr <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// initial capacity was placed in threshold</span>
        newCap <span class="token operator">=</span> oldThr<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>               <span class="token comment">// zero initial threshold signifies using defaults</span>
        newCap <span class="token operator">=</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span><span class="token punctuation">;</span>
        newThr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_LOAD_FACTOR</span> <span class="token operator">*</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newThr <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">float</span> ft <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>newCap <span class="token operator">*</span> loadFactor<span class="token punctuation">;</span>
        newThr <span class="token operator">=</span> <span class="token punctuation">(</span>newCap <span class="token operator">&lt;</span> <span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">&amp;&amp;</span> ft <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>ft <span class="token operator">:</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    threshold <span class="token operator">=</span> newThr<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;rawtypes&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTab <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>newCap<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//#1</span>
    table <span class="token operator">=</span> newTab<span class="token punctuation">;</span><span class="token comment">//#2</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldTab <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> oldCap<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å¾ªç¯åŸtableï¼ŒæŠŠåŸtableä¸­çš„æ¯ä¸ªé“¾è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ æ”¾å…¥æ–°table</span>
            <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> e<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>next <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token comment">//æŒ‡çš„æ˜¯é“¾è¡¨ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥ç›´æ¥å§eæ”¾å…¥æ–°tableï¼Œå…¶ä¸­e.hash&amp;(newCap-1)å°±æ˜¯è®¡ç®—eåœ¨æ–°tableä¸­çš„ä½ç½®ï¼Œå’ŒJDK1.7ä¸­indexFor()ä½œç”¨ä¸€è‡´</span>
                    newTab<span class="token punctuation">[</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> <span class="token punctuation">(</span>newCap <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> newTab<span class="token punctuation">,</span> j<span class="token punctuation">,</span> oldCap<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// preserve order</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> loHead <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> loTail <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> hiHead <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> hiTail <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> next<span class="token punctuation">;</span>
                    <span class="token keyword">do</span> <span class="token punctuation">{</span>
                        next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> oldCap<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                                loHead <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            <span class="token keyword">else</span>
                                loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            loTail <span class="token operator">=</span> e<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span> <span class="token punctuation">{</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                                hiHead <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            <span class="token keyword">else</span>
                                hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            hiTail <span class="token operator">=</span> e<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                        newTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> loHead<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                        newTab<span class="token punctuation">[</span>j <span class="token operator">+</span> oldCap<span class="token punctuation">]</span> <span class="token operator">=</span> hiHead<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> newTab<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä»£ç #1ä½ç½®ï¼Œç”¨æ–°è®¡ç®—çš„å®¹é‡newäº†ä¸€ä¸ªæ–°çš„hashè¡¨ï¼Œ#2å°†æ–°åˆ›å»ºçš„ç©ºçš„hashè¡¨èµ‹å€¼ç»™å®ä¾‹å˜é‡tableã€‚</p><p>æ­¤æ—¶å®ä¾‹å˜é‡tableæ˜¯ç©ºçš„ã€‚</p><p>å¦‚æœæ­¤æ—¶å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œgetæ—¶ï¼Œå°±ä¼šgetå‡ºnull</p><p>JDK1.7ä¸­HashMapå› ä¸ºå¤´æ’æ³•ï¼Œå¯¼è‡´getæ—¶å‡ºç°æ­»å¾ªç¯</p><h3 id="jdk1-7å¤šçº¿ç¨‹hashmapå¹¶å‘putçš„æ—¶å€™ä¸ºä½•ä¼šå‘ç”Ÿç¯å½¢é“¾è¡¨-äº§ç”Ÿæ­»å¾ªç¯" tabindex="-1"><a class="header-anchor" href="#jdk1-7å¤šçº¿ç¨‹hashmapå¹¶å‘putçš„æ—¶å€™ä¸ºä½•ä¼šå‘ç”Ÿç¯å½¢é“¾è¡¨-äº§ç”Ÿæ­»å¾ªç¯" aria-hidden="true">#</a> JDK1.7å¤šçº¿ç¨‹HashMapå¹¶å‘putçš„æ—¶å€™ä¸ºä½•ä¼šå‘ç”Ÿç¯å½¢é“¾è¡¨ï¼Œäº§ç”Ÿæ­»å¾ªç¯ï¼Ÿ</h3><hr><p>HashMapæ‰©å®¹æºç </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTable<span class="token punctuation">,</span> <span class="token keyword">boolean</span> rehash<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> newTable<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> e <span class="token operator">:</span> table<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//éå†åŒæ¡¶æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªæ¡¶</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//é¡ºåºéå†æŸä¸ªæ¡¶çš„å¤–æŒ‚é“¾è¡¨</span>
            <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span> <span class="token comment">//å¼•ç”¨next</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>rehash<span class="token punctuation">)</span><span class="token punctuation">{</span>
                e<span class="token punctuation">.</span>hash <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token operator">==</span> e<span class="token punctuation">.</span>key <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token function">hash</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ‰¾åˆ°æ–°è¡¨çš„æ¡¶ä½ç½® ;åŸæ¡¶æ•°ç»„ä¸­çš„æŸä¸ªæ¡¶ä¸Šçš„åŒä¸€é“¾è¡¨ä¸­çš„Entryæ­¤åˆ»å¯èƒ½è¢«åˆ†æ•£åˆ°ä¸åŒçš„æ¡¶ä¸­å»äº†ï¼Œæœ‰æ•ˆçš„ç¼“è§£äº†å“ˆå¸Œå†²çª</span>
            e<span class="token punctuation">.</span>next <span class="token operator">=</span> newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//å¤´æ’æ³•æ’å…¥æ–°è¡¨ä¸­</span>
            newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
            e <span class="token operator">=</span> next<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…ˆåˆ›å»ºä¸€ä¸ªæ•£åˆ—è¡¨HashMapï¼Œ<code>Map&lt;String,String&gt; map = new HashMap&lt;&gt;(2)</code>;åŠ è½½å› å­é»˜è®¤æ˜¯0.75ï¼Œå½“æ’å…¥ç¬¬äºŒä¸ªå…ƒç´ æ—¶ï¼Œä¼šå‘ç”Ÿæ‰©å®¹ï¼Œæˆ‘ä»¬ç°åœ¨mapä¸­æ”¾å…¥&quot;itqiankun&quot;,&quot;com&quot;ä¸¤ä¸ªå…ƒç´ ï¼Œå‡è®¾è¿™ä¸¤ä¸ªå…ƒç´ çš„éƒ½åœ¨åŒä¸€ä¸ªæ•°ç»„çš„ä½ç½®</p><figure><img src="/assets/images/hashmap06.png" alt="put" tabindex="0" loading="lazy"><figcaption>put</figcaption></figure><p>è¿™æ—¶æœ‰ä¸¤ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œputæ“ä½œï¼Œé‚£ä¹ˆåœ¨æ­¤åˆ»ä¸¤ä¸ªçº¿ç¨‹éƒ½å¯¹HashMapè¿›è¡Œæ‰©å®¹ï¼Œè¿™æ—¶å€™åœ¨æºç ä¸­ï¼ˆå…³é”®ä»£ç ï¼‰<code>Entry&lt;K,V&gt; next = e.next</code>,æ­¤æ—¶å‘ç”Ÿrehashï¼Œçº¿ç¨‹Aå’Œçº¿ç¨‹Bï¼Œä¸¤ä¸ªçº¿ç¨‹éƒ½ä¼šæ–°å»ºæ–°çš„æ•°ç»„</p><p>å‡å¦‚ä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«æ˜¯Aï¼ŒBä¸¤ä¸ªçº¿ç¨‹ã€‚Açº¿ç¨‹åœ¨æ‰§è¡Œåˆ°å…³é”®ä»£ç è¿™ä¸€è¡Œå°±è¢«æŒ‚èµ·ï¼Œé‚£ä¹ˆæ­¤åˆ»Açº¿ç¨‹ä¸­<code>e = &quot;itqiankun&quot;</code>,<code>next = &quot;com&quot;</code>,æ¥ç€Bçº¿ç¨‹å¼€å§‹è¿›è¡Œæ‰©å®¹ï¼Œå‡è®¾æ–°çš„æ•£åˆ—è¡¨ä¸­ï¼ŒèŠ‚ç‚¹&quot;itqiankun&quot;å’ŒèŠ‚ç‚¹comè¿˜æ˜¯ä¼šå‘ç”Ÿæ•£åˆ—å†²çªï¼Œé‚£ä¹ˆBçº¿ç¨‹çš„æ‰©å®¹è¿‡ç¨‹ä¸ºï¼š</p><p>å°†èŠ‚ç‚¹&quot;itqiankun&quot;è¿ç§»è‡³æ–°æ•£åˆ—è¡¨</p><figure><img src="/assets/images/hashmap07.png" alt="itqiankun" tabindex="0" loading="lazy"><figcaption>itqiankun</figcaption></figure><p>å°†comè¿ç§»è‡³æ–°æ•£åˆ—è¡¨ä¸­</p><figure><img src="/assets/images/hashmap08.png" alt="com" tabindex="0" loading="lazy"><figcaption>com</figcaption></figure><p>æ­¤æ—¶Bçº¿ç¨‹çš„æ‰©å®¹å·²ç»å®Œæˆï¼Œå³èŠ‚ç‚¹comå’Œåç»§èŠ‚ç‚¹ä¸º&quot;itqiankun&quot;ï¼ŒèŠ‚ç‚¹&quot;itqiankun&quot;çš„åè®°èŠ‚ç‚¹ä¸ºnullã€‚</p><p>æ­¤æ—¶Açº¿ç¨‹åœ¨æ‰§è¡Œåˆ°å…³é”®ä»£ç è¿™ä¸€è¡Œå¤„äºæŒ‚èµ·çŠ¶æ€ï¼Œé‚£ä¹ˆæ­¤åˆ»Açº¿ç¨‹ä¸­<code>e = &quot;itqiankun&quot;</code>ï¼Œå¹¶å°†<code>next = &quot;com&quot;</code>çš„èŠ‚ç‚¹èµ‹å€¼ç»™e,æ‰©å®¹å¹¶è¿ç§»èŠ‚ç‚¹itqiankunåçš„çŠ¶æ€ï¼Œå¦‚ä¸‹å›¾ï¼š</p><figure><img src="/assets/images/hashmap09.png" alt="A" tabindex="0" loading="lazy"><figcaption>A</figcaption></figure><p>äºæ˜¯åœ¨ç¬¬äºŒæ¬¡æ‰§è¡Œwhileå¾ªç¯çš„æ—¶å€™ï¼Œå½“å‰å¾…å¤„ç†çš„èŠ‚ç‚¹<code>e=&quot;com&quot;</code></p><p>åœ¨æ‰§è¡Œï¼ˆå…³é”®ä»£ç ï¼‰è¿™ä¸€è¡Œæ—¶ï¼Œ<!----></p><figure><img src="/assets/images/hashmap08.png" alt="com" tabindex="0" loading="lazy"><figcaption>com</figcaption></figure><p>æ¥ç€å¼€å§‹æ‰§è¡Œç¬¬ä¸‰æ¬¡whileå¾ªç¯ï¼Œå½“æ‰§è¡Œåˆ°<code>e.next=newTable[i]</code>çš„æ—¶å€™ï¼Œæ­¤æ—¶ç»“æœä¸º</p><figure><img src="/assets/images/hashmap10.png" alt="A" tabindex="0" loading="lazy"><figcaption>A</figcaption></figure><p>ç”±äºèŠ‚ç‚¹itqiankunçš„åç»§èŠ‚ç‚¹ä¸ºnullï¼Œæ‰€ä»¥next=null,æ‰§è¡Œå®Œç¬¬ä¸‰æ¬¡å¾ªç¯åï¼Œå¾ªç¯ç»“æŸï¼Œæ­¤æ—¶é“¾è¡¨æˆç¯ï¼Œget()æ—¶ä¼šå¯¼è‡´æ­»å¾ªç¯ã€‚</p></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: 2584982513@qq.com">Jingxc</span>,<!--]--><!--[--><span class="contributor" title="email: 2584982513@qq.com">jingxc</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><a href="/knowledge/thread.html" class="nav-link prev" aria-label="çº¿ç¨‹"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="font-icon icon iconfont icon-asynchronous" style=""></span>çº¿ç¨‹</div></a><a href="/knowledge/bio-nio.html" class="nav-link next" aria-label="IOæ¨¡å‹"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">IOæ¨¡å‹<span class="font-icon icon iconfont icon-IO" style=""></span></div></a></nav><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">è”ç³»æˆ‘ | Copyright Â© 2018-present Jingxc</div><div class="copyright">Copyright Â© 2023 Jingxc</div></footer></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-2a97de68.js" defer></script>
  </body>
</html>
